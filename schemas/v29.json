{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LLM mini-program specification v29.0.0",
  "type": "object",
  "definitions": {
    "semver": {
      "type": "string",
      "pattern": "^v(?:0|[1-9]\\d*)(?:\\.(?:0|[1-9]\\d*)){0,2}(?:-(?:0|[1-9]\\d*|[A-Za-z-][0-9A-Za-z-]*)(?:\\.(?:0|[1-9]\\d*|[A-Za-z-][0-9A-Za-z-]*))*)?(?:\\+[0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*)?$"
    },
    "eventDrivenPhaseTrigger": {
      "type": "object",
      "required": [
        "name",
        "event_source",
        "conditions",
        "payload_schema",
        "rate_limit",
        "delivery_guarantee",
        "safety_checks"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "event_source": {
          "$ref": "#/definitions/eventTriggerSource"
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/eventTriggerCondition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "payload_schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "rate_limit": {
          "$ref": "#/definitions/eventTriggerRateLimit"
        },
        "delivery_guarantee": {
          "type": "string",
          "enum": [
            "at_least_once",
            "at_most_once",
            "exactly_once"
          ]
        },
        "safety_checks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "dead_letter_policy": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "eventTriggerSource": {
      "type": "object",
      "required": [
        "kind",
        "identifier"
      ],
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "phase_output",
            "webhook",
            "queue",
            "schedule",
            "external"
          ]
        },
        "identifier": {
          "type": "string",
          "minLength": 1
        },
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "channel": {
          "type": "string"
        },
        "credentials_ref": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "eventTriggerCondition": {
      "type": "object",
      "required": [
        "type",
        "expression"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "filter",
            "threshold",
            "anomaly",
            "custom"
          ]
        },
        "expression": {
          "type": "string",
          "minLength": 1
        },
        "binding": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "eventTriggerRateLimit": {
      "type": "object",
      "required": [
        "max_events",
        "interval_seconds"
      ],
      "properties": {
        "max_events": {
          "type": "integer",
          "minimum": 1
        },
        "interval_seconds": {
          "type": "integer",
          "minimum": 1
        },
        "burst_limit": {
          "type": "integer",
          "minimum": 1
        },
        "recovery_seconds": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "schemaOrRef": {
      "description": "Schema fragment or reference describing the shape of an I/O payload.",
      "oneOf": [
        {
          "type": "object"
        },
        {
          "type": "string",
          "minLength": 2
        }
      ]
    },
    "ioSource": {
      "type": "object",
      "description": "Declarative source of an input payload so the compiler can reconstruct the dependency graph.",
      "required": [
        "kind"
      ],
      "properties": {
        "kind": {
          "type": "string",
          "enum": [
            "instance",
            "global",
            "phase_output"
          ]
        },
        "phase": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the phase that produces the referenced output port."
        },
        "port": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the output port within the producing phase."
        },
        "path": {
          "type": "string",
          "minLength": 1,
          "description": "JSON Pointer (or dot path) pointing to the data within the source envelope."
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "allOf": [
        {
          "if": {
            "properties": {
              "kind": {
                "const": "phase_output"
              }
            },
            "required": [
              "kind"
            ]
          },
          "then": {
            "required": [
              "phase",
              "port"
            ]
          }
        },
        {
          "if": {
            "properties": {
              "kind": {
                "enum": [
                  "instance",
                  "global"
                ]
              }
            },
            "required": [
              "kind"
            ]
          },
          "then": {
            "required": [
              "path"
            ]
          }
        }
      ]
    },
    "phaseInput": {
      "type": "object",
      "required": [
        "name",
        "schema",
        "source",
        "provenance",
        "classification",
        "privacy_risk_heuristic"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "source": {
          "$ref": "#/definitions/ioSource"
        },
        "description": {
          "type": "string"
        },
        "optional": {
          "type": "boolean"
        },
        "provenance": {
          "$ref": "#/definitions/dataProvenance"
        },
        "classification": {
          "$ref": "#/definitions/securityClassification"
        },
        "privacy_risk_heuristic": {
          "$ref": "#/definitions/privacyRiskHeuristic"
        }
      },
      "additionalProperties": false
    },
    "phaseOutput": {
      "type": "object",
      "required": [
        "name",
        "schema",
        "persistence",
        "classification",
        "integrity"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "description": {
          "type": "string"
        },
        "exposes_as": {
          "type": "string",
          "minLength": 1,
          "description": "Optional alias for wiring this output into other systems (e.g. exported return value)."
        },
        "persistence": {
          "$ref": "#/definitions/persistenceDirective",
          "description": "Directive describing where to persist the phase output; path_template must include {phase} and {output}.",
          "allOf": [
            {
              "properties": {
                "path_template": {
                  "pattern": ".*\\{phase\\}.*\\{output\\}.*"
                }
              }
            }
          ]
        },
        "classification": {
          "$ref": "#/definitions/securityClassification"
        },
        "integrity": {
          "$ref": "#/definitions/artifactIntegrity"
        }
      },
      "additionalProperties": false
    },
    "securityClassification": {
      "type": "string",
      "enum": [
        "public",
        "internal",
        "confidential",
        "restricted",
        "secret"
      ],
      "description": "Standardised data handling tier for phase inputs and outputs."
    },
    "privacyRiskHeuristic": {
      "type": "object",
      "required": [
        "methodology",
        "score",
        "confidence",
        "last_reviewed",
        "mitigations"
      ],
      "properties": {
        "methodology": {
          "type": "string",
          "minLength": 1
        },
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "confidence": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high"
          ]
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "mitigations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "artifactHash": {
      "type": "object",
      "required": [
        "algorithm",
        "value"
      ],
      "properties": {
        "algorithm": {
          "type": "string",
          "minLength": 1,
          "description": "Hashing algorithm identifier such as sha256."
        },
        "value": {
          "type": "string",
          "minLength": 16,
          "description": "Hex-encoded digest of the persisted artifact."
        },
        "canonical_source": {
          "type": "string",
          "minLength": 1,
          "description": "URI or path indicating where the digest was computed."
        }
      },
      "additionalProperties": false
    },
    "artifactIntegrity": {
      "type": "object",
      "required": [
        "hashes",
        "attestations"
      ],
      "properties": {
        "hashes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/artifactHash"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "attestations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/attestationRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "verification_schedule": {
          "type": "string",
          "description": "Frequency or trigger for re-validating stored artifacts."
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "phaseOutputRef": {
      "type": "object",
      "required": [
        "phase",
        "port"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "port": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": false
    },
    "branchDescriptor": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "controlNode": {
      "type": "object",
      "required": [
        "type"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "phase",
            "if",
            "loop",
            "parallel",
            "end"
          ]
        },
        "phase": {
          "type": "string",
          "minLength": 1,
          "description": "Name of the phase executed by this node. Defaults to the node id when omitted."
        },
        "description": {
          "type": "string"
        },
        "condition": {
          "type": "string",
          "minLength": 1,
          "description": "Expression or natural-language condition evaluated by this node."
        },
        "branches": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/branchDescriptor"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "until": {
          "type": "string",
          "minLength": 1,
          "description": "Termination condition for loop nodes (expressed as natural language or DSL)."
        },
        "body": {
          "type": "string",
          "minLength": 1,
          "description": "Entry node executed for each loop iteration."
        },
        "max_iterations": {
          "type": "integer",
          "minimum": 1,
          "description": "Optional safety bound on loop iterations."
        },
        "join": {
          "type": "string",
          "minLength": 1,
          "description": "Node that synchronises parallel branches."
        },
        "metadata": {
          "type": "object"
        }
      },
      "patternProperties": {
        "^x-": {}
      },
      "additionalProperties": false,
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {
                "const": "phase"
              }
            },
            "required": [
              "type"
            ]
          },
          "then": {
            "properties": {
              "condition": false,
              "branches": false,
              "until": false,
              "body": false,
              "max_iterations": false,
              "join": false
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "if"
              }
            },
            "required": [
              "type"
            ]
          },
          "then": {
            "required": [
              "condition",
              "branches"
            ],
            "properties": {
              "body": false,
              "until": false,
              "max_iterations": false
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "loop"
              }
            },
            "required": [
              "type"
            ]
          },
          "then": {
            "required": [
              "body",
              "until",
              "max_iterations"
            ],
            "properties": {
              "branches": false
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "parallel"
              }
            },
            "required": [
              "type"
            ]
          },
          "then": {
            "required": [
              "branches"
            ],
            "properties": {
              "condition": false,
              "until": false
            }
          }
        }
      ]
    },
    "controlEdge": {
      "type": "object",
      "required": [
        "from",
        "to",
        "kind"
      ],
      "properties": {
        "from": {
          "type": "string",
          "minLength": 1
        },
        "to": {
          "type": "string",
          "minLength": 1
        },
        "condition": {
          "type": "string",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "enum": [
            "normal",
            "success",
            "failure",
            "fallback",
            "parallel",
            "loop"
          ]
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "controlFlowGraph": {
      "type": "object",
      "required": [
        "entry",
        "nodes",
        "edges"
      ],
      "properties": {
        "entry": {
          "type": "string",
          "minLength": 1
        },
        "nodes": {
          "type": "object",
          "minProperties": 1,
          "additionalProperties": {
            "$ref": "#/definitions/controlNode"
          },
          "patternProperties": {
            "^x-": {}
          }
        },
        "edges": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/controlEdge"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "loopValidationCase": {
      "type": "object",
      "required": [
        "condition",
        "expected_transition",
        "deterministic"
      ],
      "properties": {
        "condition": {
          "type": "string",
          "minLength": 1,
          "description": "Guard or exit expression evaluated for this iteration."
        },
        "expected_transition": {
          "type": "string",
          "minLength": 1,
          "description": "Identifier of the node or state that must be reached when the condition is satisfied."
        },
        "deterministic": {
          "type": "boolean",
          "description": "Indicates whether the transition is provably deterministic under documented constraints."
        },
        "max_iterations": {
          "type": "integer",
          "minimum": 1,
          "description": "Bound on iterations permitted while this condition remains true."
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1,
          "description": "Reference to formal validation evidence supporting this transition."
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "loopValidationTable": {
      "type": "object",
      "required": [
        "loop_node",
        "transition_cases",
        "validation_owner"
      ],
      "properties": {
        "loop_node": {
          "type": "string",
          "minLength": 1,
          "description": "Control-flow node identifier for the loop under validation."
        },
        "transition_cases": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/loopValidationCase"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "validation_owner": {
          "type": "string",
          "minLength": 1,
          "description": "Accountable role responsible for maintaining deterministic loop behaviour."
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "determinism_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "stateDescriptor": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "linked_phase": {
          "type": "string",
          "minLength": 1,
          "description": "Optional reference to the phase predominantly executed while in this state."
        },
        "entry_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "exit_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "risk_level": {
          "type": "string",
          "enum": [
            "info",
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "stateTransition": {
      "type": "object",
      "required": [
        "from",
        "to"
      ],
      "properties": {
        "from": {
          "type": "string",
          "minLength": 1
        },
        "to": {
          "type": "string",
          "minLength": 1
        },
        "guard": {
          "type": "string",
          "minLength": 1,
          "description": "Predicate or condition required to fire the transition."
        },
        "trigger": {
          "type": "string",
          "minLength": 1,
          "description": "Event or output driving the transition."
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "enforced_phase": {
          "type": "string",
          "minLength": 1,
          "description": "Phase that must successfully complete to satisfy this transition."
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "stateMachine": {
      "type": "object",
      "required": [
        "states",
        "transitions",
        "initial_state",
        "terminal_states"
      ],
      "properties": {
        "states": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/stateDescriptor"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "initial_state": {
          "type": "string",
          "minLength": 1
        },
        "terminal_states": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "transitions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/stateTransition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "invariants": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseError": {
      "type": "object",
      "required": [
        "code",
        "description"
      ],
      "properties": {
        "code": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "severity": {
          "type": "string",
          "enum": [
            "fatal",
            "retryable",
            "warning"
          ]
        },
        "metadata": {
          "type": "object"
        }
      },
      "patternProperties": {
        "^x-": {}
      },
      "additionalProperties": false
    },
    "retryBackoff": {
      "type": "object",
      "properties": {
        "strategy": {
          "type": "string",
          "enum": [
            "fixed",
            "linear",
            "exponential",
            "jittered"
          ]
        },
        "initial_delay_ms": {
          "type": "integer",
          "minimum": 0
        },
        "max_delay_ms": {
          "type": "integer",
          "minimum": 0
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "retryPolicy": {
      "type": "object",
      "properties": {
        "max_attempts": {
          "type": "integer",
          "minimum": 1
        },
        "retryable_errors": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "backoff": {
          "$ref": "#/definitions/retryBackoff"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseFallback": {
      "type": "object",
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "reason": {
          "type": "string"
        },
        "mode": {
          "type": "string",
          "enum": [
            "replace",
            "append",
            "manual"
          ]
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseDeprecationMilestone": {
      "type": "object",
      "required": [
        "name",
        "deadline",
        "owner"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "deadline": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "status": {
          "type": "string",
          "enum": [
            "planned",
            "in_progress",
            "completed",
            "blocked"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseDeprecationPlan": {
      "type": "object",
      "required": [
        "current_phase",
        "status",
        "milestones",
        "owner"
      ],
      "properties": {
        "current_phase": {
          "type": "string",
          "minLength": 1
        },
        "status": {
          "type": "string",
          "enum": [
            "evaluation",
            "sunsetting",
            "deprecated",
            "retired"
          ]
        },
        "sunset_version": {
          "$ref": "#/definitions/semver"
        },
        "replacement_phase": {
          "type": "string"
        },
        "communications_plan": {
          "type": "string"
        },
        "milestones": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phaseDeprecationMilestone"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "qualityMetric": {
      "type": "object",
      "required": [
        "name",
        "target"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "target": {
          "type": "number",
          "minimum": 0
        },
        "unit": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "scoring_formula": {
          "$ref": "#/definitions/scoringFormula"
        },
        "aggregation_window": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseSemantics": {
      "type": "object",
      "required": [
        "category",
        "quality_metrics"
      ],
      "properties": {
        "category": {
          "type": "string",
          "enum": [
            "classification",
            "extraction",
            "generation",
            "summarization",
            "routing",
            "retrieval",
            "post-processing",
            "evaluation",
            "analysis"
          ]
        },
        "capabilities": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "quality_metrics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/qualityMetric"
          },
          "uniqueItems": true,
          "minItems": 1
        },
        "ontology_ref": {
          "type": "string",
          "format": "uri"
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compositionField": {
      "type": "object",
      "required": [
        "name",
        "source"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "source": {
          "$ref": "#/definitions/ioSource"
        },
        "transform": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compositionArrayItem": {
      "type": "object",
      "properties": {
        "source": {
          "$ref": "#/definitions/ioSource"
        },
        "expression": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        }
      },
      "anyOf": [
        {
          "required": [
            "source"
          ]
        },
        {
          "required": [
            "expression"
          ]
        }
      ],
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compositionTemplate": {
      "type": "object",
      "required": [
        "template"
      ],
      "properties": {
        "template": {
          "type": "string",
          "minLength": 1
        },
        "variables": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "source"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "source": {
                "$ref": "#/definitions/ioSource"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "uniqueItems": true
        },
        "description": {
          "type": "string"
        },
        "grammar": {
          "$ref": "#/definitions/promptGrammar"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compositionExpression": {
      "type": "object",
      "required": [
        "expression"
      ],
      "properties": {
        "expression": {
          "type": "string",
          "minLength": 1
        },
        "language": {
          "type": "string",
          "enum": [
            "jsonpath",
            "jmespath",
            "jq",
            "liquid"
          ]
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compositionBuild": {
      "type": "object",
      "properties": {
        "object": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compositionField"
          },
          "minItems": 1
        },
        "array": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compositionArrayItem"
          },
          "minItems": 1
        },
        "template": {
          "$ref": "#/definitions/compositionTemplate"
        },
        "expression": {
          "$ref": "#/definitions/compositionExpression"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "anyOf": [
        {
          "required": [
            "object"
          ]
        },
        {
          "required": [
            "array"
          ]
        },
        {
          "required": [
            "template"
          ]
        },
        {
          "required": [
            "expression"
          ]
        }
      ]
    },
    "compositionOutput": {
      "type": "object",
      "required": [
        "name",
        "build",
        "persistence"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "build": {
          "$ref": "#/definitions/compositionBuild"
        },
        "persistence": {
          "$ref": "#/definitions/persistenceDirective",
          "description": "Directive describing final output persistence with placeholders {output} and optional {timestamp}.",
          "allOf": [
            {
              "properties": {
                "path_template": {
                  "pattern": ".*\\{output\\}.*"
                }
              }
            }
          ]
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "artifactSource": {
      "type": "object",
      "required": [
        "uri",
        "type",
        "version",
        "checksum",
        "integrity",
        "attestations"
      ],
      "properties": {
        "uri": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "code",
            "prompt",
            "model",
            "dataset",
            "config",
            "script",
            "other"
          ]
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "checksum": {
          "type": "string",
          "minLength": 6
        },
        "integrity": {
          "type": "object",
          "required": [
            "algorithm",
            "value"
          ],
          "properties": {
            "algorithm": {
              "type": "string",
              "minLength": 1
            },
            "value": {
              "type": "string",
              "minLength": 6
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "description": {
          "type": "string"
        },
        "metadata": {
          "type": "object"
        },
        "attestations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/attestationRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compilerIRArtifact": {
      "type": "object",
      "required": [
        "name",
        "stage",
        "format",
        "hash",
        "source"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "stage": {
          "type": "string",
          "enum": [
            "parsing",
            "analysis",
            "optimization",
            "planning",
            "execution",
            "custom"
          ]
        },
        "format": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "hash": {
          "$ref": "#/definitions/artifactHash"
        },
        "source": {
          "type": "string",
          "minLength": 1,
          "description": "Reference to the compiler module that emitted this artifact."
        },
        "inputs": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "outputs": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "deterministic": {
          "type": "boolean"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compilerIRManifest": {
      "type": "object",
      "required": [
        "release_version",
        "compiler_version",
        "ir_artifacts",
        "determinism_proof"
      ],
      "properties": {
        "release_version": {
          "$ref": "#/definitions/semver"
        },
        "compiler_version": {
          "type": "string",
          "minLength": 1
        },
        "ir_schema_version": {
          "type": "string",
          "minLength": 1
        },
        "entrypoint": {
          "type": "string",
          "minLength": 1
        },
        "ir_artifacts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compilerIRArtifact"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "determinism_proof": {
          "type": "string",
          "minLength": 1,
          "description": "Summary of evidence demonstrating reproducible IR generation."
        },
        "validation_checks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "prepared_at": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "toolchainComponent": {
      "type": "object",
      "required": [
        "name",
        "version",
        "role"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "role": {
          "type": "string",
          "enum": [
            "compiler",
            "runtime",
            "linter",
            "formatter",
            "bundler",
            "validator",
            "custom"
          ]
        },
        "hash": {
          "$ref": "#/definitions/artifactHash"
        },
        "source": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "toolchainManifest": {
      "type": "object",
      "required": [
        "name",
        "locked_at",
        "components"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "locked_at": {
          "type": "string",
          "format": "date-time"
        },
        "components": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/toolchainComponent"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "reproducibility_notes": {
          "type": "string"
        },
        "attestations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/attestationRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "datasetLineageRecord": {
      "type": "object",
      "required": [
        "name",
        "role",
        "source_uri",
        "version",
        "ingest_timestamp",
        "privacy_risk_heuristic"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "role": {
          "type": "string",
          "enum": [
            "training",
            "evaluation",
            "fine_tuning",
            "monitoring",
            "augmentation"
          ]
        },
        "source_uri": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "ingest_timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "sensitivity": {
          "type": "string",
          "enum": [
            "public",
            "internal",
            "confidential",
            "restricted"
          ]
        },
        "governance_owner": {
          "type": "string",
          "minLength": 1
        },
        "retention_policy": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        },
        "quality_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "privacy_risk_heuristic": {
          "$ref": "#/definitions/privacyRiskHeuristic"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "dataLineage": {
      "type": "object",
      "required": [
        "datasets"
      ],
      "properties": {
        "datasets": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/datasetLineageRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "lineage_owner": {
          "type": "string",
          "minLength": 1
        },
        "governance_policy": {
          "type": "string"
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseDependencyEdge": {
      "type": "object",
      "required": [
        "from_phase",
        "to_phase",
        "data_paths",
        "provenance_controls"
      ],
      "properties": {
        "from_phase": {
          "type": "string",
          "minLength": 1
        },
        "to_phase": {
          "type": "string",
          "minLength": 1
        },
        "purpose": {
          "type": "string"
        },
        "data_paths": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "provenance_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "access_classification": {
          "type": "string",
          "enum": [
            "public",
            "internal",
            "confidential",
            "restricted"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "dataDependencyMatrix": {
      "type": "object",
      "required": [
        "phases",
        "dependencies",
        "last_reviewed"
      ],
      "properties": {
        "phases": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "dependencies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phaseDependencyEdge"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "serviceObjective": {
      "type": "object",
      "required": [
        "name",
        "metric",
        "target"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "metric": {
          "type": "string",
          "minLength": 1
        },
        "target": {
          "type": "number",
          "minimum": 0
        },
        "window": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "governanceProfile": {
      "type": "object",
      "required": [
        "risk_tier",
        "review_cadence",
        "approvers",
        "service_objectives",
        "oversight_capability_matrix"
      ],
      "properties": {
        "risk_tier": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "review_cadence": {
          "type": "string",
          "minLength": 1
        },
        "approvers": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "compliance": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "service_objectives": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/serviceObjective"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "audit_trail": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        },
        "oversight_capability_matrix": {
          "$ref": "#/definitions/oversightCapabilityMatrix"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "guardCondition": {
      "type": "object",
      "required": [
        "expression",
        "action"
      ],
      "properties": {
        "expression": {
          "type": "string",
          "minLength": 1
        },
        "action": {
          "type": "string",
          "enum": [
            "allow",
            "block",
            "escalate",
            "sanitize"
          ]
        },
        "description": {
          "type": "string"
        },
        "severity": {
          "type": "string",
          "enum": [
            "info",
            "warning",
            "error",
            "critical"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "runtimeGuard": {
      "type": "object",
      "required": [
        "name",
        "type",
        "enforced",
        "conditions",
        "conflict_resolution"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "rate_limit",
            "tool_whitelist",
            "content_filter",
            "context_filter",
            "output_validation",
            "circuit_breaker",
            "custom"
          ]
        },
        "description": {
          "type": "string"
        },
        "enforced": {
          "type": "boolean"
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardCondition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "severity": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "telemetry_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "conflict_resolution": {
          "$ref": "#/definitions/guardrailConflictResolution"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "guardrailConflictResolution": {
      "type": "object",
      "required": [
        "strategy",
        "decision_tree",
        "escalation_paths",
        "fallback_action",
        "audit_requirements"
      ],
      "properties": {
        "strategy": {
          "type": "string",
          "enum": [
            "priority",
            "sequential",
            "voting",
            "manual_override",
            "custom"
          ]
        },
        "description": {
          "type": "string"
        },
        "decision_tree": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/conflictResolutionNode"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "escalation_paths": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/conflictResolutionEscalation"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "fallback_action": {
          "type": "string",
          "minLength": 1
        },
        "audit_requirements": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "conflictResolutionNode": {
      "type": "object",
      "required": [
        "condition",
        "resolution_action",
        "outcome"
      ],
      "properties": {
        "condition": {
          "type": "string",
          "minLength": 1
        },
        "resolution_action": {
          "type": "string",
          "minLength": 1
        },
        "outcome": {
          "type": "string",
          "minLength": 1
        },
        "priority": {
          "type": "integer",
          "minimum": 0
        },
        "next": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/conflictResolutionNode"
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "conflictResolutionEscalation": {
      "type": "object",
      "required": [
        "condition",
        "roles",
        "time_limit_minutes"
      ],
      "properties": {
        "condition": {
          "type": "string",
          "minLength": 1
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "time_limit_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "escalation_channel": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "guardrailOptimizationObjective": {
      "type": "object",
      "required": [
        "name",
        "metric",
        "direction",
        "weight"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "metric": {
          "type": "string",
          "minLength": 1
        },
        "direction": {
          "type": "string",
          "enum": [
            "maximize",
            "minimize",
            "target"
          ]
        },
        "weight": {
          "type": "number",
          "minimum": 0
        },
        "target_value": {
          "type": "number"
        },
        "tolerance": {
          "type": "number",
          "minimum": 0
        },
        "priority": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "guardrailConstraint": {
      "type": "object",
      "required": [
        "metric",
        "operator",
        "threshold",
        "severity",
        "enforcement_action"
      ],
      "properties": {
        "metric": {
          "type": "string",
          "minLength": 1
        },
        "operator": {
          "type": "string",
          "enum": [
            "<",
            "<=",
            "=",
            ">=",
            ">"
          ]
        },
        "threshold": {
          "type": "number"
        },
        "phase_scope": {
          "type": "string",
          "minLength": 1
        },
        "applicability": {
          "type": "string",
          "enum": [
            "global",
            "phase",
            "tool",
            "custom"
          ]
        },
        "custom_applicability": {
          "type": "string",
          "minLength": 1
        },
        "severity": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "enforcement_action": {
          "type": "string",
          "enum": [
            "block",
            "degrade",
            "escalate",
            "notify",
            "custom"
          ]
        },
        "lookback_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "applicability": {
                "const": "custom"
              }
            },
            "required": [
              "applicability"
            ]
          },
          "then": {
            "required": [
              "custom_applicability"
            ]
          }
        },
        {
          "if": {
            "properties": {
              "enforcement_action": {
                "const": "custom"
              }
            },
            "required": [
              "enforcement_action"
            ]
          },
          "then": {
            "required": [
              "notes"
            ]
          }
        }
      ]
    },
    "guardrailConstraintSolver": {
      "type": "object",
      "required": [
        "name",
        "solver_engine",
        "optimization_strategy",
        "objectives",
        "constraints",
        "tuning_cadence",
        "decision_logging",
        "telemetry_channels"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "solver_engine": {
          "type": "string",
          "enum": [
            "milp",
            "smt",
            "bayesian",
            "heuristic",
            "custom"
          ]
        },
        "optimization_strategy": {
          "type": "string",
          "enum": [
            "weighted_sum",
            "pareto",
            "lexicographic",
            "constraint_relaxation",
            "custom"
          ]
        },
        "objectives": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardrailOptimizationObjective"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "constraints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardrailConstraint"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "tuning_cadence": {
          "type": "string",
          "minLength": 1
        },
        "telemetry_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "decision_logging": {
          "type": "object",
          "required": [
            "enabled",
            "storage",
            "retention_days"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "storage": {
              "type": "string",
              "minLength": 1
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1
            },
            "redaction_policy": {
              "type": "string"
            },
            "access_roles": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "solver_engine": {
                "const": "custom"
              }
            },
            "required": [
              "solver_engine"
            ]
          },
          "then": {
            "required": [
              "notes"
            ]
          }
        },
        {
          "if": {
            "properties": {
              "optimization_strategy": {
                "const": "custom"
              }
            },
            "required": [
              "optimization_strategy"
            ]
          },
          "then": {
            "required": [
              "notes"
            ]
          }
        }
      ]
    },
    "telemetryStream": {
      "type": "object",
      "required": [
        "name",
        "schema",
        "frequency",
        "destinations"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "frequency": {
          "type": "string",
          "minLength": 1
        },
        "destinations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "retention": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "escalationPolicy": {
      "type": "object",
      "required": [
        "trigger",
        "actions"
      ],
      "properties": {
        "trigger": {
          "type": "string",
          "minLength": 1
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "max_response_time_seconds": {
          "type": "number",
          "minimum": 0
        },
        "severity": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "guardrailHotSwapPolicy": {
      "type": "object",
      "required": [
        "name",
        "eligible_guards",
        "approver_roles",
        "audit",
        "rollback_actions",
        "toggle_approval"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "eligible_guards": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "trigger_conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "approver_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "audit": {
          "type": "object",
          "required": [
            "channels",
            "retention_days"
          ],
          "properties": {
            "channels": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1
            },
            "review_owner": {
              "type": "string",
              "minLength": 1
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "rollback_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "cooldown_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        },
        "toggle_approval": {
          "$ref": "#/definitions/guardrailToggleApprovalWorkflow"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "energyTelemetryRequirement": {
      "type": "object",
      "required": [
        "metric",
        "unit",
        "collection_interval",
        "aggregation",
        "destinations"
      ],
      "properties": {
        "metric": {
          "type": "string",
          "minLength": 1
        },
        "unit": {
          "type": "string",
          "minLength": 1
        },
        "collection_interval": {
          "type": "string",
          "minLength": 1
        },
        "aggregation": {
          "type": "string",
          "minLength": 1
        },
        "instrumentation_scope": {
          "type": "string",
          "enum": [
            "program",
            "phase",
            "tool"
          ]
        },
        "destinations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "threshold": {
          "type": "number",
          "minimum": 0
        },
        "alert_policy": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "sandboxEscapeHeuristic": {
      "type": "object",
      "required": [
        "name",
        "signals",
        "response_plan",
        "detection_window_seconds"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "signals": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "detection_window_seconds": {
          "type": "integer",
          "minimum": 1
        },
        "confidence_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "response_plan": {
          "type": "string",
          "minLength": 1
        },
        "escalation_policy": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "streamingSupportPolicy": {
      "type": "object",
      "required": [
        "name",
        "enabled",
        "buffer_strategy"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "phase_scope": {
          "type": "string",
          "minLength": 1
        },
        "tool_scope": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "buffer_strategy": {
          "type": "string",
          "enum": [
            "time_window",
            "token_window",
            "event_driven",
            "adaptive"
          ]
        },
        "max_buffer_seconds": {
          "type": "number",
          "minimum": 0
        },
        "max_buffer_tokens": {
          "type": "integer",
          "minimum": 0
        },
        "flush_interval": {
          "type": "string"
        },
        "fallback_behavior": {
          "type": "string"
        },
        "telemetry_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "concurrencyBudgetPolicy": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "max_parallelism",
        "recovery_seconds"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "enum": [
            "program",
            "phase",
            "branch",
            "tool"
          ]
        },
        "target": {
          "type": "string",
          "minLength": 1,
          "description": "Identifier of the node, phase, or tool this budget governs."
        },
        "max_parallelism": {
          "type": "integer",
          "minimum": 1
        },
        "burst_limit": {
          "type": "integer",
          "minimum": 1
        },
        "recovery_seconds": {
          "type": "integer",
          "minimum": 0
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "emergencyShutdownPlan": {
      "type": "object",
      "required": [
        "name",
        "triggers",
        "actions",
        "communication_plan",
        "recovery_steps"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "triggers": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "communication_plan": {
          "type": "string",
          "minLength": 1
        },
        "recovery_steps": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "approval_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "max_completion_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "watermarkingPolicy": {
      "type": "object",
      "required": [
        "name",
        "technique",
        "scope",
        "verification_method"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "technique": {
          "type": "string",
          "enum": [
            "statistical",
            "cryptographic",
            "metadata",
            "custom"
          ]
        },
        "scope": {
          "type": "string",
          "enum": [
            "program",
            "phase",
            "output"
          ]
        },
        "targets": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "verification_method": {
          "type": "string",
          "minLength": 1
        },
        "rotation_schedule": {
          "type": "string"
        },
        "enabled": {
          "type": "boolean"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "runtimeControls": {
      "type": "object",
      "required": [
        "guards",
        "telemetry",
        "escalation_policies",
        "anomaly_detectors",
        "alert_suppression_rules",
        "kill_switches",
        "audit_sinks",
        "privileged_sessions",
        "tamper_protections",
        "resource_quotas",
        "concurrency_budgets",
        "sandbox_escape_detection",
        "energy_telemetry",
        "streaming_policies",
        "guardrail_hot_swap_policies",
        "guardrail_constraint_solvers",
        "emergency_shutdowns",
        "watermarking_policies",
        "secure_enclave_attestations",
        "trust_signal_aggregators"
      ],
      "properties": {
        "guards": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/runtimeGuard"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "telemetry": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/telemetryStream"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "escalation_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/escalationPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "anomaly_detectors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/anomalyDetector"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "alert_suppression_rules": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/alertSuppressionRule"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "kill_switches": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/killSwitch"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "audit_sinks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/auditSink"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "privileged_sessions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/privilegedSessionControl"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "tamper_protections": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/tamperProtection"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "resource_quotas": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/resourceQuota"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "concurrency_budgets": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/concurrencyBudgetPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "sandbox_escape_detection": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/sandboxEscapeHeuristic"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "energy_telemetry": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/energyTelemetryRequirement"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "streaming_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/streamingSupportPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "guardrail_hot_swap_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardrailHotSwapPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "guardrail_constraint_solvers": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardrailConstraintSolver"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "emergency_shutdowns": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/emergencyShutdownPlan"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "watermarking_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/watermarkingPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        },
        "secure_enclave_attestations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/secureEnclaveAttestationRequirement"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "trust_signal_aggregators": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/trustSignalAggregator"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "alertSuppressionRule": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "conditions",
        "duration_minutes",
        "audit_window_minutes"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "enum": [
            "program",
            "phase",
            "guard",
            "anomaly_detector"
          ]
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "expression",
              "reason"
            ],
            "properties": {
              "expression": {
                "type": "string",
                "minLength": 1
              },
              "reason": {
                "type": "string",
                "minLength": 1
              },
              "channels": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "snooze_level": {
                "type": "string",
                "enum": [
                  "info",
                  "warning",
                  "error",
                  "critical"
                ]
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "duration_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "audit_window_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "auto_resume_condition": {
          "type": "string"
        },
        "requires_approval": {
          "type": "boolean"
        },
        "approver_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "killSwitch": {
      "type": "object",
      "required": [
        "name",
        "conditions",
        "action",
        "max_disable_minutes"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardCondition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "action": {
          "type": "string",
          "enum": [
            "halt_program",
            "trigger_failover",
            "degrade_to_safe"
          ]
        },
        "max_disable_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "cooldown_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "review_window_hours": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "auditSink": {
      "type": "object",
      "required": [
        "name",
        "destination",
        "retention_days",
        "storage_class",
        "encryption",
        "monitored_by"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "destination": {
          "type": "string",
          "minLength": 1
        },
        "retention_days": {
          "type": "integer",
          "minimum": 30
        },
        "storage_class": {
          "type": "string",
          "enum": [
            "append_only",
            "immutable",
            "versioned"
          ]
        },
        "encryption": {
          "$ref": "#/definitions/persistenceEncryption"
        },
        "integrity_guards": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitored_by": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "ingestion_latency_sla_seconds": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "privilegedSessionControl": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "approval_chain",
        "max_session_minutes",
        "monitoring_channels"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "enum": [
            "tool",
            "phase",
            "global"
          ]
        },
        "approval_chain": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "max_session_minutes": {
          "type": "integer",
          "minimum": 5
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "break_glass_conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardCondition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "session_logging": {
          "type": "string",
          "enum": [
            "mandatory",
            "mirrored"
          ]
        },
        "review_window_hours": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "tamperProtection": {
      "type": "object",
      "required": [
        "name",
        "mechanism",
        "scope",
        "monitoring_channels",
        "response_plan"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "mechanism": {
          "type": "string",
          "enum": [
            "immutable_storage",
            "checkpoint_attestation",
            "dual_control",
            "runtime_attestor",
            "custom"
          ]
        },
        "scope": {
          "type": "string",
          "enum": [
            "logs",
            "persistence",
            "runtime_state",
            "tool_invocations",
            "configuration"
          ]
        },
        "coverage": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "response_plan": {
          "type": "string",
          "minLength": 1
        },
        "alert_threshold_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "mechanism": {
                "const": "custom"
              }
            },
            "required": [
              "mechanism"
            ]
          },
          "then": {
            "required": [
              "notes"
            ]
          }
        }
      ]
    },
    "toolUsageLimit": {
      "type": "object",
      "required": [
        "metric",
        "threshold",
        "window_minutes",
        "enforcement_action"
      ],
      "properties": {
        "metric": {
          "type": "string",
          "enum": [
            "calls",
            "tokens",
            "latency_ms",
            "custom"
          ]
        },
        "custom_metric_name": {
          "type": "string",
          "minLength": 1
        },
        "threshold": {
          "type": "number",
          "minimum": 0
        },
        "window_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "enforcement_action": {
          "type": "string",
          "enum": [
            "throttle",
            "block",
            "require_approval",
            "notify"
          ]
        },
        "cooldown_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "alert_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "exempt_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "metric": {
                "const": "custom"
              }
            },
            "required": [
              "metric"
            ]
          },
          "then": {
            "required": [
              "custom_metric_name"
            ]
          }
        }
      ]
    },
    "resourceQuota": {
      "type": "object",
      "required": [
        "scope",
        "target",
        "limits",
        "enforcement"
      ],
      "properties": {
        "scope": {
          "type": "string",
          "enum": [
            "program",
            "phase",
            "tool"
          ]
        },
        "target": {
          "type": "string",
          "minLength": 1,
          "description": "Identifier for the program, phase, or tool the quota applies to."
        },
        "limits": {
          "type": "object",
          "minProperties": 1,
          "properties": {
            "cpu_cores": {
              "type": "number",
              "minimum": 0
            },
            "memory_mb": {
              "type": "integer",
              "minimum": 0
            },
            "network_mbps": {
              "type": "number",
              "minimum": 0
            },
            "tool_invocations_per_minute": {
              "type": "number",
              "minimum": 0
            },
            "custom": {
              "type": "object",
              "additionalProperties": true
            }
          },
          "additionalProperties": false
        },
        "enforcement": {
          "type": "string",
          "enum": [
            "hard",
            "soft",
            "monitor"
          ]
        },
        "burst_allowance": {
          "type": "number",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "segregationControl": {
      "type": "object",
      "required": [
        "control_id",
        "enforced",
        "roles",
        "incompatible_roles",
        "break_glass_policy"
      ],
      "properties": {
        "control_id": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "enforced": {
          "type": "boolean"
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "incompatible_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "break_glass_policy": {
          "type": "string",
          "minLength": 1
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "review_frequency_days": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "toolPolicy": {
      "type": "object",
      "required": [
        "tool",
        "allowed_actions",
        "guardrails",
        "access_tier",
        "usage_limits",
        "segregation_controls"
      ],
      "properties": {
        "tool": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "allowed_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "blocked_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "guardrails": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/runtimeGuard"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "usage_limits": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/toolUsageLimit"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "segregation_controls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/segregationControl"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "access_tier": {
          "type": "string",
          "enum": [
            "standard",
            "elevated",
            "restricted"
          ]
        },
        "review_cadence": {
          "type": "string",
          "minLength": 1
        },
        "credential_source": {
          "type": "string",
          "minLength": 1
        },
        "privileged_session_policy": {
          "$ref": "#/definitions/privilegedSessionControl"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "riskEntry": {
      "type": "object",
      "required": [
        "id",
        "description",
        "probability",
        "impact",
        "mitigations",
        "status"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "probability": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "impact": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "mitigations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "status": {
          "type": "string",
          "enum": [
            "open",
            "monitoring",
            "mitigated",
            "accepted"
          ]
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "riskRegister": {
      "type": "object",
      "required": [
        "owner",
        "last_reviewed",
        "entries"
      ],
      "properties": {
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/riskEntry"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "controlImpactRecord": {
      "type": "object",
      "required": [
        "control_reference",
        "business_risk",
        "change_summary",
        "expected_outcome"
      ],
      "properties": {
        "control_reference": {
          "type": "string",
          "minLength": 1
        },
        "business_risk": {
          "type": "string",
          "minLength": 1
        },
        "change_summary": {
          "type": "string",
          "minLength": 1
        },
        "expected_outcome": {
          "type": "string",
          "minLength": 1
        },
        "impact_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "residual_risk_classification": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "mitigation_owner": {
          "type": "string",
          "minLength": 1
        },
        "review_date": {
          "type": "string",
          "format": "date"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "impactAnalysis": {
      "type": "object",
      "required": [
        "methodology",
        "control_impacts"
      ],
      "properties": {
        "methodology": {
          "type": "string",
          "minLength": 1
        },
        "summary": {
          "type": "string"
        },
        "control_impacts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/controlImpactRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "approved_by": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "assuranceTest": {
      "type": "object",
      "required": [
        "name",
        "objective",
        "type",
        "frequency",
        "gating"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "objective": {
          "type": "string"
        },
        "type": {
          "type": "string",
          "enum": [
            "unit",
            "integration",
            "simulation",
            "red_team",
            "evaluation"
          ]
        },
        "frequency": {
          "type": "string",
          "minLength": 1
        },
        "gating": {
          "type": "boolean"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "scenarioProbe": {
      "type": "object",
      "required": [
        "name",
        "trigger",
        "expected_outcome",
        "simulation_controls"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "trigger": {
          "type": "string",
          "minLength": 1,
          "description": "Event, prompt, or input that initiates the scenario probe."
        },
        "expected_outcome": {
          "type": "string",
          "minLength": 1
        },
        "evaluation_metric": {
          "type": "string",
          "minLength": 1
        },
        "tolerances": {
          "type": "object"
        },
        "notes": {
          "type": "string"
        },
        "simulation_controls": {
          "$ref": "#/definitions/simulationControlParameters"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "governanceScenario": {
      "type": "object",
      "required": [
        "name",
        "target_controls",
        "risk_focus",
        "probes",
        "success_threshold"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "target_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "risk_focus": {
          "type": "string",
          "minLength": 1
        },
        "probes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/scenarioProbe"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "success_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum proportion of probes that must pass to consider the scenario successful."
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "redTeamIntegrationWorkflow": {
      "type": "object",
      "required": [
        "phases",
        "handoffs",
        "verification_steps"
      ],
      "properties": {
        "phases": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "handoffs": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "from",
              "to",
              "artifact"
            ],
            "properties": {
              "from": {
                "type": "string",
                "minLength": 1
              },
              "to": {
                "type": "string",
                "minLength": 1
              },
              "artifact": {
                "type": "string",
                "minLength": 1
              },
              "checklist": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "verification_steps": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "telemetry_hooks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "approval_gates": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "redTeamWorkflow": {
      "type": "object",
      "required": [
        "scenario_name",
        "integration_points",
        "cadence",
        "owner",
        "reporting_channels",
        "integration_workflow"
      ],
      "properties": {
        "scenario_name": {
          "type": "string",
          "minLength": 1
        },
        "integration_points": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "cadence": {
          "type": "string",
          "minLength": 1
        },
        "entry_criteria": {
          "type": "string"
        },
        "exit_criteria": {
          "type": "string"
        },
        "tooling": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "reporting_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "integration_workflow": {
          "$ref": "#/definitions/redTeamIntegrationWorkflow"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "formalVerificationHook": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "artifact",
        "proof_system",
        "status"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "artifact": {
          "type": "string",
          "minLength": 1
        },
        "proof_system": {
          "type": "string",
          "minLength": 1
        },
        "status": {
          "type": "string",
          "enum": [
            "planned",
            "in_progress",
            "passing",
            "failing"
          ]
        },
        "last_run": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "federatedEvaluationNode": {
      "type": "object",
      "required": [
        "node_id",
        "dataset",
        "weight",
        "scoring_method",
        "privacy_guarantees"
      ],
      "properties": {
        "node_id": {
          "type": "string",
          "minLength": 1
        },
        "dataset": {
          "type": "string",
          "minLength": 1
        },
        "weight": {
          "type": "number",
          "minimum": 0
        },
        "scoring_method": {
          "type": "string",
          "minLength": 1
        },
        "aggregation_ready": {
          "type": "boolean"
        },
        "privacy_guarantees": {
          "type": "object",
          "required": [
            "mechanism"
          ],
          "properties": {
            "mechanism": {
              "type": "string",
              "minLength": 1
            },
            "epsilon": {
              "type": "number",
              "minimum": 0
            },
            "delta": {
              "type": "number",
              "minimum": 0
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "compliance_notes": {
          "type": "string"
        },
        "telemetry_channel": {
          "type": "string"
        },
        "last_updated": {
          "type": "string",
          "format": "date-time"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "federatedEvaluationAggregate": {
      "type": "object",
      "required": [
        "name",
        "cohorts",
        "aggregation_method",
        "reporting_window",
        "compliance_constraints"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "cohorts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/federatedEvaluationNode"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "aggregation_method": {
          "type": "string",
          "enum": [
            "weighted_mean",
            "median",
            "trimmed_mean",
            "max",
            "custom"
          ]
        },
        "reporting_window": {
          "type": "string",
          "minLength": 1
        },
        "differential_privacy": {
          "type": "object",
          "required": [
            "enabled"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "epsilon": {
              "type": "number",
              "minimum": 0
            },
            "delta": {
              "type": "number",
              "minimum": 0
            },
            "noise_mechanism": {
              "type": "string"
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "compliance_constraints": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "metrics_reported": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_links": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "aggregation_method": {
                "const": "custom"
              }
            },
            "required": [
              "aggregation_method"
            ]
          },
          "then": {
            "required": [
              "notes"
            ]
          }
        }
      ]
    },
    "assuranceProgram": {
      "type": "object",
      "required": [
        "tests",
        "exit_criteria",
        "drift_monitors",
        "scenario_tests",
        "red_team_workflows",
        "formal_verification",
        "calibration_datasets",
        "federated_evaluations"
      ],
      "properties": {
        "tests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/assuranceTest"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "exit_criteria": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "drift_monitors": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "scenario_tests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/governanceScenario"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "red_team_workflows": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/redTeamWorkflow"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "formal_verification": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/formalVerificationHook"
          },
          "uniqueItems": true,
          "minItems": 1
        },
        "coverage_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "notes": {
          "type": "string"
        },
        "calibration_datasets": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/calibrationDataset"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "federated_evaluations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/federatedEvaluationAggregate"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "incidentPlaybook": {
      "type": "object",
      "required": [
        "name",
        "trigger",
        "roles",
        "actions",
        "communication_channels",
        "post_incident_review_window_hours"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "trigger": {
          "type": "string",
          "minLength": 1
        },
        "roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "communication_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "post_incident_review_window_hours": {
          "type": "integer",
          "minimum": 1
        },
        "severity": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "privacyIncidentWorkflow": {
      "type": "object",
      "required": [
        "name",
        "trigger_conditions",
        "notification_channels",
        "escalation_sla_minutes",
        "regulatory_obligations",
        "responsible_roles"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "trigger_conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notification_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "escalation_sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "regulatory_obligations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "responsible_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "reporting_requirements": {
          "type": "string"
        },
        "evidence_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "post_incident_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "vulnerabilityDisclosureWorkflow": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "intake_channels",
        "triage_process",
        "response_sla_minutes",
        "notification_targets"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "intake_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "triage_process": {
          "type": "string",
          "minLength": 1
        },
        "response_sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "notification_targets": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "public_disclosure_policy": {
          "type": "string"
        },
        "coordinated_response_partners": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "remediationPlaybook": {
      "type": "object",
      "required": [
        "name",
        "kpi",
        "trigger_condition",
        "actions",
        "owner",
        "sla_minutes"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "kpi": {
          "type": "string",
          "minLength": 1
        },
        "trigger_condition": {
          "type": "string",
          "minLength": 1
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "success_metrics": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "rollback_criteria": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "observabilityHook": {
      "type": "object",
      "required": [
        "stream",
        "signals",
        "sampling",
        "correlation"
      ],
      "properties": {
        "stream": {
          "type": "string",
          "minLength": 1
        },
        "signals": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "sampling": {
          "type": "string",
          "minLength": 1
        },
        "alert_thresholds": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        },
        "correlation": {
          "$ref": "#/definitions/correlationTraceability"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "attestationRecord": {
      "type": "object",
      "required": [
        "type",
        "issuer",
        "issued_at",
        "scope",
        "evidence_uri"
      ],
      "properties": {
        "type": {
          "type": "string",
          "minLength": 1
        },
        "issuer": {
          "type": "string",
          "minLength": 1
        },
        "issued_at": {
          "type": "string",
          "format": "date-time"
        },
        "expires_at": {
          "type": "string",
          "format": "date-time"
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "signature": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "humanReviewProtocol": {
      "type": "object",
      "required": [
        "roles",
        "trigger",
        "checklist",
        "sla_minutes",
        "blocking",
        "audit_trail",
        "access_policies"
      ],
      "properties": {
        "roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "trigger": {
          "type": "string",
          "minLength": 1
        },
        "checklist": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "blocking": {
          "type": "boolean"
        },
        "escalation": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        },
        "audit_trail": {
          "$ref": "#/definitions/humanInterventionAuditTrail"
        },
        "access_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/reviewerAccessPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "reviewerAccessPolicy": {
      "type": "object",
      "required": [
        "role",
        "visibility_scope",
        "masking_rules",
        "justification",
        "approver_roles"
      ],
      "properties": {
        "role": {
          "type": "string",
          "minLength": 1
        },
        "visibility_scope": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "masking_rules": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "justification": {
          "type": "string",
          "minLength": 1
        },
        "approver_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "expiration": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "humanEscalationStage": {
      "type": "object",
      "required": [
        "role",
        "responsibility",
        "sla_minutes"
      ],
      "properties": {
        "role": {
          "type": "string",
          "minLength": 1
        },
        "responsibility": {
          "type": "string",
          "minLength": 1
        },
        "contact": {
          "type": "string"
        },
        "sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "fallback_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "humanEscalationTemplate": {
      "type": "object",
      "required": [
        "name",
        "risk_tier",
        "triggers",
        "actions",
        "escalation_chain",
        "audit_trail"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "risk_tier": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "triggers": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "escalation_chain": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/humanEscalationStage"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "fallback_decision_window_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "audit_trail": {
          "$ref": "#/definitions/humanInterventionAuditTrail"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "credentialRotationPolicy": {
      "type": "object",
      "required": [
        "cadence",
        "method",
        "owner",
        "evidence_uri"
      ],
      "properties": {
        "cadence": {
          "type": "string",
          "minLength": 1
        },
        "method": {
          "type": "string",
          "minLength": 1
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "automation": {
          "type": "boolean"
        },
        "last_rotation": {
          "type": "string",
          "format": "date-time"
        },
        "next_rotation_due": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "multiTenantIsolationGuarantee": {
      "type": "object",
      "required": [
        "tenancy_model",
        "isolation_controls",
        "validation_frequency",
        "evidence_artifacts",
        "break_glass_procedure",
        "responsible_team"
      ],
      "properties": {
        "tenancy_model": {
          "type": "string",
          "enum": [
            "shared",
            "pooled",
            "dedicated",
            "hybrid"
          ]
        },
        "isolation_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "segmentation_strategy": {
          "type": "string"
        },
        "validation_frequency": {
          "type": "string",
          "minLength": 1
        },
        "evidence_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "break_glass_procedure": {
          "type": "string",
          "minLength": 1
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "last_validated": {
          "type": "string",
          "format": "date-time"
        },
        "responsible_team": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "deploymentEnvironment": {
      "type": "object",
      "required": [
        "name",
        "classification",
        "regions",
        "controls",
        "change_management",
        "credential_rotation",
        "multi_tenant_isolation"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "classification": {
          "type": "string",
          "enum": [
            "development",
            "staging",
            "production",
            "restricted"
          ]
        },
        "regions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "change_management": {
          "type": "string",
          "minLength": 1
        },
        "secrets_policy": {
          "type": "string"
        },
        "credential_rotation": {
          "$ref": "#/definitions/credentialRotationPolicy"
        },
        "multi_tenant_isolation": {
          "$ref": "#/definitions/multiTenantIsolationGuarantee"
        },
        "monitoring": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        },
        "overlays": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/environmentOverlay"
          },
          "uniqueItems": true
        },
        "default_overlay": {
          "type": "string",
          "minLength": 1
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "multiRegionDisasterRecoveryManifest": {
      "type": "object",
      "required": [
        "regions",
        "orchestration_playbook",
        "failover_sequence",
        "communication_plan",
        "recovery_time_objective_minutes",
        "recovery_point_objective_minutes",
        "testing_schedule",
        "reentry_criteria"
      ],
      "properties": {
        "regions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 2,
          "uniqueItems": true
        },
        "orchestration_playbook": {
          "$ref": "#/definitions/disasterRecoveryPlaybook"
        },
        "failover_sequence": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/failoverStep"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "communication_plan": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "recovery_time_objective_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "recovery_point_objective_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "testing_schedule": {
          "$ref": "#/definitions/drTestSchedule"
        },
        "reentry_criteria": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "disasterRecoveryPlaybook": {
      "type": "object",
      "required": [
        "name",
        "command_center_roles",
        "phases"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "command_center_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "phases": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "objectives"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "objectives": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "contingencies": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "tools": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "failoverStep": {
      "type": "object",
      "required": [
        "order",
        "action",
        "responsible_roles",
        "expected_duration_minutes",
        "success_criteria"
      ],
      "properties": {
        "order": {
          "type": "integer",
          "minimum": 0
        },
        "action": {
          "type": "string",
          "minLength": 1
        },
        "responsible_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "expected_duration_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "success_criteria": {
          "type": "string",
          "minLength": 1
        },
        "rollback_step": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "drTestSchedule": {
      "type": "object",
      "required": [
        "frequency",
        "last_test",
        "next_test",
        "scenarios"
      ],
      "properties": {
        "frequency": {
          "type": "string",
          "minLength": 1
        },
        "last_test": {
          "type": "string",
          "format": "date-time"
        },
        "next_test": {
          "type": "string",
          "format": "date-time"
        },
        "scenarios": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owners": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "waiverRecord": {
      "type": "object",
      "required": [
        "control_id",
        "justification",
        "approved_by",
        "status",
        "expires_at"
      ],
      "properties": {
        "control_id": {
          "type": "string",
          "minLength": 1
        },
        "justification": {
          "type": "string"
        },
        "approved_by": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "status": {
          "type": "string",
          "enum": [
            "pending",
            "approved",
            "expired",
            "revoked"
          ]
        },
        "issued_at": {
          "type": "string",
          "format": "date-time"
        },
        "expires_at": {
          "type": "string",
          "format": "date-time"
        },
        "mitigations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "lineageRecord": {
      "type": "object",
      "required": [
        "version",
        "timestamp",
        "changes",
        "approved_by"
      ],
      "properties": {
        "version": {
          "type": "string",
          "minLength": 1
        },
        "timestamp": {
          "type": "string",
          "format": "date-time"
        },
        "changes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "approved_by": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "dataProvenance": {
      "type": "object",
      "required": [
        "source",
        "collection_method",
        "lawful_basis",
        "classification",
        "retention",
        "last_refreshed"
      ],
      "properties": {
        "source": {
          "type": "string",
          "minLength": 1
        },
        "collection_method": {
          "type": "string",
          "minLength": 1
        },
        "lawful_basis": {
          "type": "string",
          "minLength": 1
        },
        "classification": {
          "type": "string",
          "enum": [
            "public",
            "internal",
            "confidential",
            "restricted",
            "sensitive"
          ]
        },
        "retention": {
          "type": "string",
          "minLength": 1
        },
        "last_refreshed": {
          "type": "string",
          "format": "date-time"
        },
        "data_owner": {
          "type": "string",
          "minLength": 1
        },
        "pii": {
          "type": "boolean"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "ethicalGuardrail": {
      "type": "object",
      "required": [
        "risk",
        "mitigation",
        "protected_groups",
        "monitoring"
      ],
      "properties": {
        "risk": {
          "type": "string",
          "minLength": 1
        },
        "mitigation": {
          "type": "string"
        },
        "protected_groups": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitoring": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "baseline_metric": {
          "type": "string",
          "minLength": 1
        },
        "threshold": {
          "type": "number"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "controlRiskFactor": {
      "type": "object",
      "required": [
        "name",
        "weight",
        "score"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "weight": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "score": {
          "type": "number",
          "minimum": 0
        },
        "justification": {
          "type": "string"
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "controlRiskScoring": {
      "type": "object",
      "required": [
        "methodology",
        "scale",
        "overall_score",
        "factors"
      ],
      "properties": {
        "methodology": {
          "type": "string",
          "minLength": 1
        },
        "overall_score": {
          "type": "number",
          "minimum": 0
        },
        "scale": {
          "type": "object",
          "required": [
            "min",
            "max",
            "unit"
          ],
          "properties": {
            "min": {
              "type": "number"
            },
            "max": {
              "type": "number"
            },
            "unit": {
              "type": "string",
              "minLength": 1
            },
            "description": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "factors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/controlRiskFactor"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "residual_risk_level": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "last_assessed": {
          "type": "string",
          "format": "date-time"
        },
        "next_review_due": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "complianceControl": {
      "type": "object",
      "required": [
        "framework",
        "control_id",
        "status",
        "evidence_uri",
        "last_audited",
        "risk_scoring",
        "evidence_proofs"
      ],
      "properties": {
        "framework": {
          "type": "string",
          "minLength": 1
        },
        "control_id": {
          "type": "string",
          "minLength": 1
        },
        "status": {
          "type": "string",
          "enum": [
            "planned",
            "in_progress",
            "pass",
            "fail",
            "waived"
          ]
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "last_audited": {
          "type": "string",
          "format": "date-time"
        },
        "risk_scoring": {
          "$ref": "#/definitions/controlRiskScoring"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        },
        "evidence_proofs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/complianceEvidenceProof"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "jurisdictionProfile": {
      "type": "object",
      "required": [
        "region",
        "regulations",
        "data_residency",
        "requirements"
      ],
      "properties": {
        "region": {
          "type": "string",
          "minLength": 1
        },
        "regulations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "data_residency": {
          "type": "string",
          "minLength": 1
        },
        "requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "local_contact": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "complianceProgram": {
      "type": "object",
      "required": [
        "framework",
        "version",
        "controls",
        "owner",
        "next_audit",
        "jurisdictions"
      ],
      "properties": {
        "framework": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "controls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/complianceControl"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "next_audit": {
          "type": "string",
          "format": "date-time"
        },
        "jurisdictions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/jurisdictionProfile"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "scope": {
          "type": "string"
        },
        "coverage": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "anomalyDetector": {
      "type": "object",
      "required": [
        "name",
        "signals",
        "thresholds",
        "response_plan",
        "sla_minutes"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "signals": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "thresholds": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "response_plan": {
          "type": "string",
          "minLength": 1
        },
        "sla_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "tooling": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "jurisdictionRetentionOverride": {
      "type": "object",
      "required": [
        "jurisdiction",
        "retention_days",
        "legal_reference",
        "escalation_contact"
      ],
      "properties": {
        "jurisdiction": {
          "type": "string",
          "minLength": 1
        },
        "retention_days": {
          "type": "integer",
          "minimum": 1
        },
        "legal_reference": {
          "type": "string",
          "minLength": 1
        },
        "applicability_conditions": {
          "type": "string"
        },
        "escalation_contact": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "dataRetentionPolicy": {
      "type": "object",
      "required": [
        "data_classification",
        "default_retention_days",
        "jurisdiction_overrides",
        "purge_process",
        "review_cadence_days",
        "data_owner"
      ],
      "properties": {
        "data_classification": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "default_retention_days": {
          "type": "integer",
          "minimum": 1
        },
        "legal_basis": {
          "type": "string"
        },
        "jurisdiction_overrides": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/jurisdictionRetentionOverride"
          },
          "uniqueItems": true
        },
        "purge_process": {
          "type": "string",
          "minLength": 1
        },
        "review_cadence_days": {
          "type": "integer",
          "minimum": 1
        },
        "data_owner": {
          "type": "string",
          "minLength": 1
        },
        "retention_exceptions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_references": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "persistencePolicy": {
      "type": "object",
      "required": [
        "base_directory",
        "relative_to",
        "extension",
        "conflict_strategy",
        "naming_template",
        "emit_manifest"
      ],
      "properties": {
        "base_directory": {
          "type": "string",
          "const": "tmp"
        },
        "relative_to": {
          "type": "string",
          "const": "cwd"
        },
        "extension": {
          "type": "string",
          "const": ".save"
        },
        "conflict_strategy": {
          "type": "string",
          "enum": [
            "append_timestamp",
            "overwrite",
            "error"
          ]
        },
        "notes": {
          "type": "string"
        },
        "naming_template": {
          "$ref": "#/definitions/persistenceNamingTemplate"
        },
        "emit_manifest": {
          "type": "boolean",
          "const": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "persistenceDirective": {
      "type": "object",
      "required": [
        "path_template",
        "relative_to",
        "write_mode",
        "trigger",
        "checksum_algorithm",
        "record_manifest"
      ],
      "properties": {
        "path_template": {
          "type": "string",
          "pattern": "^tmp/[A-Za-z0-9_\\-{}]+\\.save$"
        },
        "relative_to": {
          "type": "string",
          "const": "cwd"
        },
        "write_mode": {
          "type": "string",
          "enum": [
            "append",
            "overwrite",
            "fail_if_exists"
          ]
        },
        "trigger": {
          "type": "string",
          "enum": [
            "phase_completion",
            "on_error",
            "manual_review"
          ]
        },
        "policy_notes": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "example_path": {
          "type": "string",
          "pattern": "^tmp/[A-Za-z0-9_\\-]+\\.save$"
        },
        "checksum_algorithm": {
          "type": "string",
          "enum": [
            "sha256",
            "sha512",
            "blake2b"
          ]
        },
        "record_manifest": {
          "type": "boolean",
          "const": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "persistenceManifestEntry": {
      "type": "object",
      "required": [
        "phase",
        "output",
        "path",
        "checksum",
        "checksum_algorithm",
        "created_at",
        "retention_class",
        "encryption"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "output": {
          "type": "string",
          "minLength": 1
        },
        "path": {
          "type": "string",
          "pattern": "^tmp/[A-Za-z0-9_.\\-]+\\.save$"
        },
        "checksum": {
          "type": "string",
          "minLength": 6
        },
        "checksum_algorithm": {
          "type": "string",
          "enum": [
            "sha256",
            "sha512",
            "blake2b"
          ]
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "retention_class": {
          "type": "string",
          "enum": [
            "ephemeral",
            "short_term",
            "standard",
            "archival"
          ]
        },
        "purge_at": {
          "type": "string",
          "format": "date-time"
        },
        "encryption": {
          "$ref": "#/definitions/persistenceEncryption"
        },
        "size_bytes": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "releaseManifestComponent": {
      "type": "object",
      "required": [
        "name",
        "type",
        "uri",
        "checksum",
        "checksum_algorithm",
        "distribution_channel"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "schema",
            "prompt",
            "binary",
            "dataset",
            "configuration",
            "documentation",
            "metadata"
          ]
        },
        "uri": {
          "type": "string",
          "minLength": 1
        },
        "checksum": {
          "type": "string",
          "minLength": 6
        },
        "checksum_algorithm": {
          "type": "string",
          "enum": [
            "sha256",
            "sha512",
            "blake2b"
          ]
        },
        "distribution_channel": {
          "type": "string",
          "minLength": 1
        },
        "signed": {
          "type": "boolean"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "releasePackagingManifest": {
      "type": "object",
      "required": [
        "manifest_version",
        "release_id",
        "components",
        "signing",
        "distribution_plan",
        "prepared_at",
        "reproducibility_evidence"
      ],
      "properties": {
        "manifest_version": {
          "$ref": "#/definitions/semver"
        },
        "release_id": {
          "type": "string",
          "minLength": 1
        },
        "prepared_at": {
          "type": "string",
          "format": "date-time"
        },
        "release_manager": {
          "type": "string",
          "minLength": 1
        },
        "components": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/releaseManifestComponent"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "signing": {
          "type": "object",
          "required": [
            "required"
          ],
          "properties": {
            "required": {
              "type": "boolean"
            },
            "algorithm": {
              "type": "string"
            },
            "key_reference": {
              "type": "string"
            },
            "timestamp_authority": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "distribution_plan": {
          "type": "string",
          "minLength": 1
        },
        "compliance_tags": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        },
        "reproducibility_evidence": {
          "$ref": "#/definitions/reproducibilityEvidencePackage"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "fragmentMigrationPlan": {
      "type": "object",
      "required": [
        "strategy",
        "backward_compatible"
      ],
      "properties": {
        "strategy": {
          "type": "string",
          "minLength": 1
        },
        "backward_compatible": {
          "type": "boolean"
        },
        "fallback_version": {
          "$ref": "#/definitions/semver"
        },
        "sunset_date": {
          "type": "string",
          "format": "date-time"
        },
        "validation_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "migratableSchemaFragment": {
      "type": "object",
      "required": [
        "name",
        "version",
        "schema",
        "interop_targets",
        "migration_plan"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "version": {
          "$ref": "#/definitions/semver"
        },
        "status": {
          "type": "string",
          "enum": [
            "experimental",
            "stable",
            "deprecated"
          ]
        },
        "schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "interop_targets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "version": {
                "type": "string"
              },
              "interface": {
                "type": "string"
              },
              "capabilities": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "migration_plan": {
          "$ref": "#/definitions/fragmentMigrationPlan"
        },
        "validation_hooks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "persistenceEncryption": {
      "type": "object",
      "required": [
        "status",
        "algorithm"
      ],
      "properties": {
        "status": {
          "type": "string",
          "enum": [
            "encrypted_at_rest",
            "tokenized"
          ]
        },
        "algorithm": {
          "type": "string",
          "minLength": 1
        },
        "key_reference": {
          "type": "string",
          "minLength": 1
        },
        "rotation_days": {
          "type": "integer",
          "minimum": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "persistenceNamingTemplate": {
      "type": "object",
      "required": [
        "format",
        "components"
      ],
      "properties": {
        "format": {
          "type": "string",
          "pattern": "^[A-Za-z0-9_\\-{}]+\\.save$"
        },
        "components": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "phase",
              "output",
              "timestamp",
              "iteration",
              "uuid"
            ]
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "privacyBudgetSegment": {
      "type": "object",
      "required": [
        "name",
        "epsilon"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "epsilon": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "delta": {
          "type": "number",
          "minimum": 0
        },
        "scope": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "max_queries": {
          "type": "integer",
          "minimum": 1
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "safetyBenchmarkCoverage": {
      "type": "object",
      "required": [
        "framework",
        "benchmark_suite",
        "coverage_ratio",
        "controls_mapped",
        "last_reviewed",
        "evidence_uri"
      ],
      "properties": {
        "framework": {
          "type": "string",
          "minLength": 1
        },
        "benchmark_suite": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "coverage_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "controls_mapped": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "methodology": {
          "type": "string"
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "assessor": {
          "type": "string",
          "minLength": 1
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "knowledgeBaseLink": {
      "type": "object",
      "required": [
        "title",
        "uri",
        "classification",
        "last_validated"
      ],
      "properties": {
        "title": {
          "type": "string",
          "minLength": 1
        },
        "uri": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "classification": {
          "type": "string",
          "enum": [
            "policy",
            "regulation",
            "playbook",
            "tutorial",
            "reference",
            "other"
          ]
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "last_validated": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "privacyBudgetPolicy": {
      "type": "object",
      "required": [
        "total_epsilon",
        "accounting_model",
        "segments"
      ],
      "properties": {
        "total_epsilon": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "total_delta": {
          "type": "number",
          "minimum": 0
        },
        "accounting_model": {
          "type": "string",
          "enum": [
            "advanced_composition",
            "zcdp",
            "renyi",
            "naive"
          ]
        },
        "reset_frequency": {
          "type": "string"
        },
        "owner": {
          "type": "string"
        },
        "monitoring": {
          "type": "object",
          "properties": {
            "reporting_cadence": {
              "type": "string"
            },
            "alert_threshold": {
              "type": "number",
              "minimum": 0
            },
            "telemetry_channel": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "segments": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/privacyBudgetSegment"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "explainabilityInputReference": {
      "type": "object",
      "required": [
        "source",
        "path",
        "summary"
      ],
      "properties": {
        "source": {
          "type": "string",
          "minLength": 1
        },
        "path": {
          "type": "string",
          "minLength": 1
        },
        "summary": {
          "type": "string",
          "minLength": 1
        },
        "data_classification": {
          "type": "string",
          "enum": [
            "public",
            "internal",
            "confidential",
            "restricted"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "explainabilityDecision": {
      "type": "object",
      "required": [
        "decision_id",
        "description",
        "rationale",
        "inputs",
        "outcome",
        "confidence"
      ],
      "properties": {
        "decision_id": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "rationale": {
          "type": "string",
          "minLength": 1
        },
        "inputs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/explainabilityInputReference"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "outcome": {
          "type": "string",
          "minLength": 1
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "human_review": {
          "type": "boolean"
        },
        "impact": {
          "type": "string"
        },
        "metrics": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseExplainabilityReport": {
      "type": "object",
      "required": [
        "phase",
        "report_id",
        "generated_at",
        "decision_points",
        "models_invoked",
        "evidence_links",
        "retention_days"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "report_id": {
          "type": "string",
          "minLength": 1
        },
        "title": {
          "type": "string"
        },
        "generated_at": {
          "type": "string",
          "format": "date-time"
        },
        "decision_points": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/explainabilityDecision"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "models_invoked": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "evidence_links": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "confidence_summary": {
          "type": "string"
        },
        "human_reviewed": {
          "type": "boolean"
        },
        "reviewer": {
          "type": "string",
          "minLength": 1
        },
        "retention_days": {
          "type": "integer",
          "minimum": 1
        },
        "distribution_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseToolCapabilityScope": {
      "type": "object",
      "required": [
        "tool",
        "allowed_actions"
      ],
      "properties": {
        "tool": {
          "type": "string",
          "minLength": 1
        },
        "allowed_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "denied_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "function_classes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "rate_limits": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/toolUsageLimit"
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "llmBehavioralContract": {
      "type": "object",
      "required": [
        "contract_name",
        "allowed_behaviors",
        "forbidden_behaviors",
        "enforcement_mechanisms",
        "violation_response",
        "monitoring_channels"
      ],
      "properties": {
        "contract_name": {
          "type": "string",
          "minLength": 1
        },
        "summary": {
          "type": "string"
        },
        "allowed_behaviors": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "forbidden_behaviors": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "contextual_constraints": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "enforcement_mechanisms": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "violation_response": {
          "type": "object",
          "required": [
            "severity_scale",
            "escalation_path",
            "actions"
          ],
          "properties": {
            "severity_scale": {
              "type": "string",
              "enum": [
                "low",
                "medium",
                "high",
                "critical"
              ]
            },
            "escalation_path": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "actions": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "grace_conditions": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "evidence_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "promptGrammarRule": {
      "type": "object",
      "required": [
        "name",
        "production"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "production": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "example": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "promptGrammar": {
      "type": "object",
      "required": [
        "dialect",
        "rules"
      ],
      "properties": {
        "dialect": {
          "type": "string",
          "enum": [
            "ebnf",
            "abnf",
            "cfg",
            "regex"
          ]
        },
        "version": {
          "type": "string"
        },
        "entry_rule": {
          "type": "string"
        },
        "rules": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/promptGrammarRule"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "formulaVariable": {
      "type": "object",
      "required": [
        "name",
        "source"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "source": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "scoringFormula": {
      "type": "object",
      "required": [
        "expression"
      ],
      "properties": {
        "expression": {
          "type": "string",
          "minLength": 1
        },
        "language": {
          "type": "string",
          "enum": [
            "affine",
            "python",
            "sql",
            "dsl"
          ]
        },
        "deterministic": {
          "type": "boolean"
        },
        "variables": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/formulaVariable"
          },
          "uniqueItems": true
        },
        "tolerance": {
          "type": "number",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "auditFieldDescriptor": {
      "type": "object",
      "required": [
        "name",
        "type"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "type": {
          "type": "string",
          "enum": [
            "string",
            "number",
            "integer",
            "boolean",
            "timestamp",
            "json"
          ]
        },
        "required": {
          "type": "boolean"
        },
        "pii": {
          "type": "boolean"
        },
        "description": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "humanInterventionAuditTrail": {
      "type": "object",
      "required": [
        "storage",
        "fields"
      ],
      "properties": {
        "storage": {
          "type": "string",
          "minLength": 1
        },
        "fields": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/auditFieldDescriptor"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "retention_days": {
          "type": "integer",
          "minimum": 1
        },
        "hashing": {
          "type": "string"
        },
        "access_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "environmentOverlay": {
      "type": "object",
      "required": [
        "name",
        "inherits",
        "overrides"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "inherits": {
          "type": "string",
          "minLength": 1
        },
        "overrides": {
          "type": "object"
        },
        "activation_rules": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "condition"
            ],
            "properties": {
              "condition": {
                "type": "string",
                "minLength": 1
              },
              "description": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "modelFallbackStrategy": {
      "type": "object",
      "required": [
        "name",
        "primary_model",
        "fallback_models",
        "activation_mode",
        "selection_criteria",
        "conditions"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "primary_model": {
          "type": "string",
          "minLength": 1
        },
        "fallback_models": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "activation_mode": {
          "type": "string",
          "enum": [
            "automatic",
            "manual",
            "hybrid"
          ]
        },
        "selection_criteria": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "conditions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/guardCondition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "recovery_plan": {
          "type": "string"
        },
        "telemetry_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "continualLearningGovernance": {
      "type": "object",
      "required": [
        "handoff_owner",
        "approval_roles",
        "retraining_frequency",
        "eligibility_criteria",
        "handoff_steps",
        "evaluation_gates",
        "safeguards",
        "rollback_strategy"
      ],
      "properties": {
        "handoff_owner": {
          "type": "string",
          "minLength": 1
        },
        "approval_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "retraining_frequency": {
          "type": "string",
          "minLength": 1
        },
        "eligibility_criteria": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "handoff_steps": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/learningHandoffStep"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "evaluation_gates": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/retrainingGate"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "safeguards": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "rollback_strategy": {
          "type": "string",
          "minLength": 1
        },
        "monitoring_hooks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "learningHandoffStep": {
      "type": "object",
      "required": [
        "name",
        "description",
        "evidence_required",
        "owner"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "evidence_required": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "handoff_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "retrainingGate": {
      "type": "object",
      "required": [
        "name",
        "metrics",
        "thresholds",
        "approver_roles",
        "decision"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "metrics": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "thresholds": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "metric",
              "operator",
              "value"
            ],
            "properties": {
              "metric": {
                "type": "string",
                "minLength": 1
              },
              "operator": {
                "type": "string",
                "enum": [
                  "<",
                  "<=",
                  ">",
                  ">=",
                  "==",
                  "!="
                ]
              },
              "value": {
                "oneOf": [
                  {
                    "type": "number"
                  },
                  {
                    "type": "string",
                    "minLength": 1
                  }
                ]
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "approver_roles": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "decision": {
          "type": "string",
          "enum": [
            "approve",
            "reject",
            "hold"
          ]
        },
        "cooldown_days": {
          "type": "integer",
          "minimum": 0
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "secureEnclaveAttestationRequirement": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "phase",
        "attestation_provider",
        "measurements",
        "evidence_uri"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "attestation_provider": {
          "type": "string",
          "minLength": 1
        },
        "measurements": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_uri": {
          "type": "string",
          "minLength": 1
        },
        "refresh_cadence_days": {
          "type": "integer",
          "minimum": 1
        },
        "hardware_root_of_trust": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "guardrailToggleApprovalWorkflow": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "workflow_id",
        "required_signoffs",
        "lead_time_minutes"
      ],
      "properties": {
        "workflow_id": {
          "type": "string",
          "minLength": 1
        },
        "required_signoffs": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "lead_time_minutes": {
          "type": "integer",
          "minimum": 0
        },
        "documentation_uri": {
          "type": "string",
          "minLength": 1
        },
        "change_board": {
          "type": "string",
          "minLength": 1
        },
        "emergency_bypass": {
          "type": "object",
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          },
          "required": [
            "allowed"
          ],
          "properties": {
            "allowed": {
              "type": "boolean"
            },
            "conditions": {
              "type": "string"
            },
            "approval_roles": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            }
          }
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "correlationTraceability": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "identifier_name",
        "propagation_map"
      ],
      "properties": {
        "identifier_name": {
          "type": "string",
          "minLength": 1
        },
        "format": {
          "type": "string",
          "minLength": 1
        },
        "generator": {
          "type": "string",
          "minLength": 1
        },
        "propagation_map": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "phase",
              "field"
            ],
            "properties": {
              "phase": {
                "type": "string",
                "minLength": 1
              },
              "field": {
                "type": "string",
                "minLength": 1
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "uniqueItems": true
        },
        "retention": {
          "type": "string",
          "minLength": 1
        },
        "telemetry_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "calibrationDataset": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "name",
        "dataset_uri",
        "version",
        "benchmark_metrics"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "dataset_uri": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "benchmark_metrics": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "refresh_cadence_days": {
          "type": "integer",
          "minimum": 1
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "simulationControlParameters": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "random_seed",
        "iterations"
      ],
      "properties": {
        "random_seed": {
          "oneOf": [
            {
              "type": "integer"
            },
            {
              "type": "string",
              "minLength": 1
            }
          ]
        },
        "iterations": {
          "type": "integer",
          "minimum": 1
        },
        "burn_in": {
          "type": "integer",
          "minimum": 0
        },
        "step_size": {
          "type": "number",
          "exclusiveMinimum": 0
        },
        "noise_model": {
          "type": "string",
          "minLength": 1
        },
        "stochastic_parameters": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "name",
              "distribution"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "distribution": {
                "type": "string",
                "minLength": 1
              },
              "constraints": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "uniqueItems": true
        },
        "determinism_budget": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "reproducibilityEvidencePackage": {
      "type": "object",
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      },
      "required": [
        "run_identifiers",
        "execution_context",
        "random_seed_records"
      ],
      "properties": {
        "run_identifiers": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "execution_context": {
          "type": "object",
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          },
          "required": [
            "platform",
            "toolchain_versions"
          ],
          "properties": {
            "platform": {
              "type": "string",
              "minLength": 1
            },
            "environment": {
              "type": "string"
            },
            "toolchain_versions": {
              "type": "array",
              "minItems": 1,
              "items": {
                "type": "object",
                "additionalProperties": false,
                "patternProperties": {
                  "^x-": {}
                },
                "required": [
                  "name",
                  "version"
                ],
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1
                  },
                  "version": {
                    "type": "string",
                    "minLength": 1
                  },
                  "commit": {
                    "type": "string"
                  },
                  "notes": {
                    "type": "string"
                  }
                }
              },
              "uniqueItems": true
            }
          }
        },
        "random_seed_records": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "phase",
              "seed"
            ],
            "properties": {
              "phase": {
                "type": "string",
                "minLength": 1
              },
              "seed": {
                "oneOf": [
                  {
                    "type": "integer"
                  },
                  {
                    "type": "string",
                    "minLength": 1
                  }
                ]
              },
              "source": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "uniqueItems": true
        },
        "artifact_digests": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "name",
              "algorithm",
              "value"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "algorithm": {
                "type": "string",
                "minLength": 1
              },
              "value": {
                "type": "string",
                "minLength": 1
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      }
    },
    "auditEventSignature": {
      "type": "object",
      "required": [
        "event_id",
        "hash_algorithm",
        "hash_value",
        "signature_algorithm",
        "signature_value",
        "public_key_reference",
        "issued_at",
        "signing_authority",
        "evidence_scope"
      ],
      "properties": {
        "event_id": {
          "type": "string",
          "minLength": 1
        },
        "hash_algorithm": {
          "type": "string",
          "enum": [
            "sha256",
            "sha384",
            "sha512",
            "blake2b"
          ]
        },
        "hash_value": {
          "type": "string",
          "minLength": 32
        },
        "signature_algorithm": {
          "type": "string",
          "enum": [
            "rsa-pss-sha256",
            "ecdsa-p256-sha256",
            "ed25519"
          ]
        },
        "signature_value": {
          "type": "string",
          "minLength": 32
        },
        "public_key_reference": {
          "type": "string",
          "minLength": 1
        },
        "issued_at": {
          "type": "string",
          "format": "date-time"
        },
        "signing_authority": {
          "type": "string",
          "minLength": 1
        },
        "evidence_scope": {
          "type": "string",
          "minLength": 1
        },
        "nonce": {
          "type": "string",
          "minLength": 1
        },
        "evidence_uri": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "fairnessDriftRootCauseReport": {
      "type": "object",
      "required": [
        "id",
        "detected_at",
        "drift_signal",
        "analysis_summary",
        "suspected_causes",
        "confidence_level",
        "recommended_actions",
        "owner"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "detected_at": {
          "type": "string",
          "format": "date-time"
        },
        "drift_signal": {
          "type": "string",
          "minLength": 1
        },
        "analysis_summary": {
          "type": "string",
          "minLength": 1
        },
        "suspected_causes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "confidence_level": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high"
          ]
        },
        "recommended_actions": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "description",
              "owner",
              "due_date",
              "status"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "owner": {
                "type": "string",
                "minLength": 1
              },
              "due_date": {
                "type": "string",
                "format": "date"
              },
              "status": {
                "type": "string",
                "enum": [
                  "planned",
                  "in_progress",
                  "complete"
                ]
              },
              "evidence_link": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "data_segments_impacted": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_links": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "reviewed_at": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "configurationDriftManifest": {
      "type": "object",
      "required": [
        "baseline_environment",
        "target_environment",
        "generated_at",
        "drift_items"
      ],
      "properties": {
        "baseline_environment": {
          "type": "string",
          "minLength": 1
        },
        "target_environment": {
          "type": "string",
          "minLength": 1
        },
        "generated_at": {
          "type": "string",
          "format": "date-time"
        },
        "author": {
          "type": "string"
        },
        "diff_algorithm": {
          "type": "string"
        },
        "drift_items": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/configurationDriftItem"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "severity_summary": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "critical": {
              "type": "integer",
              "minimum": 0
            },
            "high": {
              "type": "integer",
              "minimum": 0
            },
            "medium": {
              "type": "integer",
              "minimum": 0
            },
            "low": {
              "type": "integer",
              "minimum": 0
            },
            "informational": {
              "type": "integer",
              "minimum": 0
            }
          }
        },
        "review_status": {
          "type": "string",
          "enum": [
            "draft",
            "in_review",
            "approved",
            "remediated"
          ]
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "configurationDriftItem": {
      "type": "object",
      "required": [
        "path",
        "category",
        "baseline_value",
        "target_value",
        "severity"
      ],
      "properties": {
        "path": {
          "type": "string",
          "minLength": 1
        },
        "category": {
          "type": "string",
          "enum": [
            "parameter",
            "secret",
            "policy",
            "dependency",
            "runtime",
            "other"
          ]
        },
        "baseline_value": {
          "type": "string"
        },
        "target_value": {
          "type": "string"
        },
        "severity": {
          "type": "string",
          "enum": [
            "critical",
            "high",
            "medium",
            "low",
            "informational"
          ]
        },
        "impact": {
          "type": "string"
        },
        "detection_method": {
          "type": "string"
        },
        "ticket_reference": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "promptInjectionDetectionProfile": {
      "type": "object",
      "required": [
        "id",
        "heuristic_name",
        "version",
        "parameters",
        "thresholds",
        "evaluation_metrics",
        "last_reviewed",
        "owner"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "heuristic_name": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "parameters": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "name",
              "value",
              "type"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "value": {
                "type": "string",
                "minLength": 1
              },
              "type": {
                "type": "string",
                "enum": [
                  "numeric",
                  "boolean",
                  "enum",
                  "string"
                ]
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "thresholds": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "metric",
              "operator",
              "value",
              "action"
            ],
            "properties": {
              "metric": {
                "type": "string",
                "minLength": 1
              },
              "operator": {
                "type": "string",
                "enum": [
                  ">",
                  ">=",
                  "<",
                  "<=",
                  "==",
                  "!="
                ]
              },
              "value": {
                "type": "number"
              },
              "action": {
                "type": "string",
                "enum": [
                  "block",
                  "escalate",
                  "sanitize",
                  "log"
                ]
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "evaluation_metrics": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "name",
              "value",
              "sample_size"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "value": {
                "type": "number"
              },
              "sample_size": {
                "type": "integer",
                "minimum": 1
              },
              "target": {
                "type": "number"
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "test_cases": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "detection_coverage": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        },
        "automation_level": {
          "type": "string",
          "enum": [
            "none",
            "partial",
            "full"
          ]
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "ethicalReviewDecisionLogEntry": {
      "type": "object",
      "required": [
        "decision_id",
        "submitted_at",
        "reviewed_at",
        "reviewers",
        "outcome",
        "rationale",
        "conditions",
        "owner"
      ],
      "properties": {
        "decision_id": {
          "type": "string",
          "minLength": 1
        },
        "submitted_at": {
          "type": "string",
          "format": "date-time"
        },
        "reviewed_at": {
          "type": "string",
          "format": "date-time"
        },
        "reviewers": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "name",
              "role"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "role": {
                "type": "string",
                "minLength": 1
              },
              "affiliation": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "outcome": {
          "type": "string",
          "enum": [
            "approved",
            "approved_with_conditions",
            "rejected",
            "needs_revision",
            "deferred"
          ]
        },
        "rationale": {
          "type": "string",
          "minLength": 1
        },
        "conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "follow_up_actions": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            },
            "required": [
              "description",
              "owner",
              "due_date",
              "status"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "owner": {
                "type": "string",
                "minLength": 1
              },
              "due_date": {
                "type": "string",
                "format": "date"
              },
              "status": {
                "type": "string",
                "enum": [
                  "open",
                  "in_progress",
                  "closed"
                ]
              },
              "notes": {
                "type": "string"
              }
            }
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "related_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "localizationQualityMetric": {
      "type": "object",
      "required": [
        "locale",
        "metric_name",
        "methodology",
        "target_threshold",
        "measurement_frequency",
        "owner"
      ],
      "properties": {
        "locale": {
          "type": "string",
          "pattern": "^[a-z]{2}(-[A-Z]{2})?$"
        },
        "metric_name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "methodology": {
          "type": "string",
          "minLength": 1
        },
        "target_threshold": {
          "type": "string",
          "minLength": 1
        },
        "warning_threshold": {
          "type": "string"
        },
        "measurement_frequency": {
          "type": "string",
          "enum": [
            "per_release",
            "monthly",
            "quarterly",
            "continuous"
          ]
        },
        "data_sources": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "automation": {
          "type": "string",
          "enum": [
            "manual",
            "semi_automated",
            "fully_automated"
          ]
        },
        "tooling": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "last_evaluated": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compilerOptimizationHint": {
      "type": "object",
      "required": [
        "name",
        "target",
        "prompt_pattern",
        "rewrite_strategy",
        "determinism_controls"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "target": {
          "type": "string",
          "enum": [
            "prompt_template",
            "phase",
            "tool_call",
            "global"
          ]
        },
        "phase_scope": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "prompt_pattern": {
          "type": "string",
          "minLength": 1
        },
        "rewrite_strategy": {
          "type": "string",
          "minLength": 1
        },
        "constraints": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "expected_gain": {
          "type": "number"
        },
        "priority": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "validation_metric": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        },
        "determinism_controls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compilerDeterminismControl"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "runtimeSafetyNet": {
      "type": "object",
      "required": [
        "name",
        "sandbox_environment",
        "trigger_conditions",
        "rollback_sequence",
        "validation_checks"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "sandbox_environment": {
          "type": "string",
          "minLength": 1
        },
        "trigger_conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "rollback_sequence": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "step",
              "action"
            ],
            "properties": {
              "step": {
                "type": "integer",
                "minimum": 1
              },
              "action": {
                "type": "string",
                "minLength": 1
              },
              "expected_outcome": {
                "type": "string"
              },
              "verification": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "validation_checks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "metric",
              "threshold"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "metric": {
                "type": "string",
                "minLength": 1
              },
              "threshold": {
                "type": "string",
                "minLength": 1
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "max_duration_minutes": {
          "type": "integer",
          "minimum": 1
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "userResearchInsight": {
      "type": "object",
      "required": [
        "id",
        "summary",
        "impact_assessment",
        "last_updated"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "title": {
          "type": "string"
        },
        "summary": {
          "type": "string",
          "minLength": 1
        },
        "impact_assessment": {
          "type": "string",
          "minLength": 1
        },
        "last_updated": {
          "type": "string",
          "format": "date-time"
        },
        "source": {
          "type": "string"
        },
        "methodology": {
          "type": "string"
        },
        "audience": {
          "type": "string"
        },
        "confidence_level": {
          "type": "string",
          "enum": [
            "low",
            "medium",
            "high"
          ]
        },
        "categories": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "related_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "evidence_links": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "oversightCapabilityMatrix": {
      "type": "object",
      "required": [
        "entries",
        "last_reviewed"
      ],
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "role",
              "capabilities",
              "coverage_scope",
              "escalation_latency_minutes",
              "readiness_level"
            ],
            "properties": {
              "role": {
                "type": "string",
                "minLength": 1
              },
              "description": {
                "type": "string"
              },
              "capabilities": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "coverage_scope": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "escalation_latency_minutes": {
                "type": "integer",
                "minimum": 0
              },
              "readiness_level": {
                "type": "string",
                "enum": [
                  "developing",
                  "proficient",
                  "expert"
                ]
              },
              "training_last_completed": {
                "type": "string",
                "format": "date"
              },
              "backup_roles": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "owner": {
          "type": "string"
        },
        "next_review_due": {
          "type": "string",
          "format": "date"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "ciComplianceGate": {
      "type": "object",
      "required": [
        "name",
        "description",
        "enforced_checks",
        "blocking",
        "automation_tooling",
        "evidence_artifacts",
        "owner"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "enforced_checks": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "blocking": {
          "type": "boolean"
        },
        "automation_tooling": {
          "type": "string",
          "minLength": 1
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "evidence_artifacts": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "last_evaluated": {
          "type": "string",
          "format": "date-time"
        },
        "rollback_conditions": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "serviceLevelNegotiation": {
      "type": "object",
      "required": [
        "contract_id",
        "partner",
        "service_scope",
        "status",
        "sla_metrics"
      ],
      "properties": {
        "contract_id": {
          "type": "string",
          "minLength": 1
        },
        "partner": {
          "type": "string",
          "minLength": 1
        },
        "service_scope": {
          "type": "string",
          "minLength": 1
        },
        "status": {
          "type": "string",
          "enum": [
            "negotiating",
            "active",
            "renewal",
            "terminated"
          ]
        },
        "effective_date": {
          "type": "string",
          "format": "date"
        },
        "renewal_date": {
          "type": "string",
          "format": "date"
        },
        "sla_metrics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/serviceObjective"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "obligations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "contacts": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "role",
              "email"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "role": {
                "type": "string",
                "minLength": 1
              },
              "email": {
                "type": "string",
                "format": "email"
              },
              "phone": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "uniqueItems": true
        },
        "exit_clauses": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "trustSignalAggregator": {
      "type": "object",
      "required": [
        "name",
        "signals",
        "aggregation_strategy",
        "update_interval_seconds"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "signals": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "source",
              "metric",
              "weight"
            ],
            "properties": {
              "source": {
                "type": "string",
                "minLength": 1
              },
              "metric": {
                "type": "string",
                "minLength": 1
              },
              "weight": {
                "type": "number"
              },
              "threshold": {
                "type": "number"
              },
              "normalization": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "aggregation_strategy": {
          "type": "string",
          "enum": [
            "weighted_average",
            "minimum",
            "maximum",
            "median",
            "custom"
          ]
        },
        "update_interval_seconds": {
          "type": "integer",
          "minimum": 1
        },
        "exposure_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "alert_threshold": {
          "type": "number"
        },
        "owner": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phaseStateCheckpointPolicy": {
      "type": "object",
      "required": [
        "phase",
        "checkpoint_name",
        "snapshot_cadence",
        "retention",
        "recovery_validation"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "checkpoint_name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "snapshot_cadence": {
          "type": "object",
          "required": [
            "frequency",
            "unit"
          ],
          "properties": {
            "frequency": {
              "type": "integer",
              "minimum": 1
            },
            "unit": {
              "type": "string",
              "enum": [
                "per_run",
                "per_phase",
                "per_iteration",
                "per_request",
                "hourly",
                "daily",
                "weekly"
              ]
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "retention": {
          "type": "object",
          "required": [
            "duration",
            "unit"
          ],
          "properties": {
            "duration": {
              "type": "integer",
              "minimum": 1
            },
            "unit": {
              "type": "string",
              "enum": [
                "hours",
                "days",
                "weeks",
                "months"
              ]
            },
            "max_versions": {
              "type": "integer",
              "minimum": 1
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "recovery_validation": {
          "type": "object",
          "required": [
            "steps",
            "success_criteria"
          ],
          "properties": {
            "steps": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "success_criteria": {
              "type": "string",
              "minLength": 1
            },
            "verification_metrics": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "evidence_artifacts": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "observabilityContractVersion": {
      "type": "object",
      "required": [
        "observability_channel",
        "schema_version",
        "effective_from",
        "change_summary"
      ],
      "properties": {
        "observability_channel": {
          "type": "string",
          "minLength": 1
        },
        "schema_version": {
          "$ref": "#/definitions/semver"
        },
        "effective_from": {
          "type": "string",
          "format": "date-time"
        },
        "deprecation_date": {
          "type": "string",
          "format": "date-time"
        },
        "change_summary": {
          "type": "string",
          "minLength": 1
        },
        "backwards_compatible": {
          "type": "boolean"
        },
        "breaking_changes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "compatibility_notes": {
          "type": "string"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "related_controls": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "llmOutputSignaturePolicy": {
      "type": "object",
      "required": [
        "name",
        "signature_algorithm",
        "key_reference",
        "covered_outputs",
        "verification_process"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "signature_algorithm": {
          "type": "string",
          "minLength": 1
        },
        "key_reference": {
          "type": "string",
          "minLength": 1
        },
        "covered_outputs": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "verification_process": {
          "type": "object",
          "required": [
            "triggers",
            "steps"
          ],
          "properties": {
            "triggers": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "steps": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "order",
                  "action"
                ],
                "properties": {
                  "order": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "action": {
                    "type": "string",
                    "minLength": 1
                  },
                  "expected_result": {
                    "type": "string"
                  },
                  "tooling": {
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "patternProperties": {
                  "^x-": {}
                }
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "fallback_actions": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "rotation_frequency": {
          "type": "string"
        },
        "validation_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "anomalyBudgetPolicy": {
      "type": "object",
      "required": [
        "name",
        "scope",
        "allowed_deviation",
        "duration",
        "expiration_conditions"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "allowed_deviation": {
          "type": "object",
          "required": [
            "metric",
            "limit"
          ],
          "properties": {
            "metric": {
              "type": "string",
              "minLength": 1
            },
            "limit": {
              "type": "number"
            },
            "unit": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "duration": {
          "type": "object",
          "required": [
            "value",
            "unit"
          ],
          "properties": {
            "value": {
              "type": "integer",
              "minimum": 1
            },
            "unit": {
              "type": "string",
              "enum": [
                "minutes",
                "hours",
                "days",
                "weeks"
              ]
            },
            "rolling_window": {
              "type": "boolean"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "expiration_conditions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitoring_channels": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "approvals": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "dataEgressControl": {
      "type": "object",
      "required": [
        "channel",
        "sanitization_requirements",
        "approval_workflow",
        "audit_logging"
      ],
      "properties": {
        "channel": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "allowed_destinations": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "sanitization_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "approval_workflow": {
          "type": "object",
          "required": [
            "roles",
            "criteria"
          ],
          "properties": {
            "roles": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "criteria": {
              "type": "string",
              "minLength": 1
            },
            "notify_channels": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "audit_logging": {
          "type": "object",
          "required": [
            "enabled"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1
            },
            "storage_location": {
              "type": "string"
            },
            "encryption": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "monitoring": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "modelConfidenceAnnotation": {
      "type": "object",
      "required": [
        "phase",
        "confidence_metric",
        "thresholds",
        "propagation_rules"
      ],
      "properties": {
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "confidence_metric": {
          "type": "string",
          "minLength": 1
        },
        "measurement_method": {
          "type": "string"
        },
        "thresholds": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "label",
              "min_value",
              "max_value"
            ],
            "properties": {
              "label": {
                "type": "string",
                "minLength": 1
              },
              "min_value": {
                "type": "number"
              },
              "max_value": {
                "type": "number"
              },
              "actions": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "propagation_rules": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "explanation_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "human_review_triggers": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "quantumResiliencePolicy": {
      "type": "object",
      "required": [
        "name",
        "threat_model",
        "mitigation_strategies",
        "validation_status",
        "review_cadence"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "threat_model": {
          "type": "string",
          "minLength": 1
        },
        "mitigation_strategies": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "validation_status": {
          "type": "string",
          "enum": [
            "planned",
            "in_review",
            "validated",
            "deprecated"
          ]
        },
        "validation_evidence": {
          "type": "string"
        },
        "review_cadence": {
          "type": "string",
          "minLength": 1
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "last_reviewed": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "responsibleAICommitment": {
      "type": "object",
      "required": [
        "framework",
        "obligations",
        "legal_reference",
        "effective_date",
        "owner"
      ],
      "properties": {
        "framework": {
          "type": "string",
          "minLength": 1
        },
        "purpose": {
          "type": "string"
        },
        "obligations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "description"
            ],
            "properties": {
              "description": {
                "type": "string",
                "minLength": 1
              },
              "evidence_uri": {
                "type": "string",
                "format": "uri"
              },
              "monitoring_requirements": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "legal_reference": {
          "type": "string",
          "minLength": 1
        },
        "effective_date": {
          "type": "string",
          "format": "date"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "renewal_cadence": {
          "type": "string"
        },
        "evidence_links": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "userPersonaAccessProfile": {
      "type": "object",
      "required": [
        "persona",
        "description",
        "guardrail_overrides",
        "allowed_tools",
        "restricted_data_classes"
      ],
      "properties": {
        "persona": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "guardrail_overrides": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "guardrail",
              "action"
            ],
            "properties": {
              "guardrail": {
                "type": "string",
                "minLength": 1
              },
              "action": {
                "type": "string",
                "enum": [
                  "tighten",
                  "loosen",
                  "replace"
                ]
              },
              "justification": {
                "type": "string"
              },
              "approval_reference": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "allowed_tools": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "restricted_data_classes": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitoring_requirements": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "phasedRolloutExperiment": {
      "type": "object",
      "required": [
        "name",
        "cohort_strategy",
        "exposure_schedule",
        "monitoring_metrics",
        "exit_criteria"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "objective": {
          "type": "string"
        },
        "cohort_strategy": {
          "type": "string",
          "minLength": 1
        },
        "exposure_schedule": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "phase_label",
              "traffic_percentage",
              "duration"
            ],
            "properties": {
              "phase_label": {
                "type": "string",
                "minLength": 1
              },
              "traffic_percentage": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "duration": {
                "type": "string",
                "minLength": 1
              },
              "entry_criteria": {
                "type": "string"
              },
              "exit_criteria": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "monitoring_metrics": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "exit_criteria": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "owner": {
          "type": "string"
        },
        "start_date": {
          "type": "string",
          "format": "date"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "incidentMetricDefinition": {
      "type": "object",
      "required": [
        "name",
        "description",
        "severity_scale",
        "duration_buckets",
        "impact_dimensions"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "minLength": 1
        },
        "severity_scale": {
          "type": "object",
          "required": [
            "levels"
          ],
          "properties": {
            "levels": {
              "type": "array",
              "items": {
                "type": "object",
                "required": [
                  "label",
                  "score_range"
                ],
                "properties": {
                  "label": {
                    "type": "string",
                    "minLength": 1
                  },
                  "score_range": {
                    "type": "string",
                    "minLength": 1
                  },
                  "description": {
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "patternProperties": {
                  "^x-": {}
                }
              },
              "minItems": 1,
              "uniqueItems": true
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "duration_buckets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "label",
              "min_minutes",
              "max_minutes"
            ],
            "properties": {
              "label": {
                "type": "string",
                "minLength": 1
              },
              "min_minutes": {
                "type": "number",
                "minimum": 0
              },
              "max_minutes": {
                "type": "number",
                "minimum": 0
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "impact_dimensions": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "dimension",
              "scoring_guidance"
            ],
            "properties": {
              "dimension": {
                "type": "string",
                "minLength": 1
              },
              "scoring_guidance": {
                "type": "string",
                "minLength": 1
              },
              "weight": {
                "type": "number",
                "minimum": 0
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "calculation_method": {
          "type": "string"
        },
        "owner": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "thirdPartyAuditAttestation": {
      "type": "object",
      "required": [
        "auditor",
        "scope",
        "issued_at",
        "findings",
        "remediation_deadline"
      ],
      "properties": {
        "auditor": {
          "type": "string",
          "minLength": 1
        },
        "scope": {
          "type": "string",
          "minLength": 1
        },
        "issued_at": {
          "type": "string",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "enum": [
            "pending",
            "in_progress",
            "complete"
          ]
        },
        "findings": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "id",
              "description",
              "severity",
              "status"
            ],
            "properties": {
              "id": {
                "type": "string",
                "minLength": 1
              },
              "description": {
                "type": "string",
                "minLength": 1
              },
              "severity": {
                "type": "string",
                "enum": [
                  "low",
                  "medium",
                  "high",
                  "critical"
                ]
              },
              "status": {
                "type": "string",
                "enum": [
                  "open",
                  "mitigated",
                  "closed"
                ]
              },
              "remediation_due": {
                "type": "string",
                "format": "date"
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "remediation_deadline": {
          "type": "string",
          "format": "date"
        },
        "evidence_uri": {
          "type": "string",
          "format": "uri"
        },
        "follow_up_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "compilerDeterminismControl": {
      "type": "object",
      "required": [
        "strategy",
        "toolchain_stage",
        "seed_management",
        "state_capture",
        "verification"
      ],
      "properties": {
        "strategy": {
          "type": "string",
          "enum": [
            "seed_locking",
            "execution_order_control",
            "toolchain_pin",
            "checkpoint_replay",
            "custom"
          ]
        },
        "toolchain_stage": {
          "type": "string",
          "enum": [
            "prompt_compilation",
            "phase_binding",
            "tool_invocation",
            "runtime",
            "post_processing"
          ]
        },
        "seed_management": {
          "type": "object",
          "required": [
            "mode",
            "scope"
          ],
          "properties": {
            "mode": {
              "type": "string",
              "enum": [
                "static",
                "dynamic",
                "per_phase",
                "per_tool"
              ]
            },
            "scope": {
              "type": "string",
              "minLength": 1
            },
            "rotation": {
              "type": "string",
              "enum": [
                "per_release",
                "per_deployment",
                "per_run",
                "per_user"
              ]
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "state_capture": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "tolerance_ms": {
          "type": "number",
          "minimum": 0
        },
        "verification": {
          "type": "object",
          "required": [
            "method",
            "frequency"
          ],
          "properties": {
            "method": {
              "type": "string",
              "enum": [
                "replay",
                "hash_compare",
                "snapshot_diff",
                "custom"
              ]
            },
            "frequency": {
              "type": "string",
              "minLength": 1
            },
            "success_criteria": {
              "type": "string"
            },
            "tooling": {
              "type": "string"
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "fallback_behavior": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "multiAgentCoordinationContract": {
      "type": "object",
      "required": [
        "name",
        "agents",
        "coordination_protocol",
        "arbitration",
        "shared_state",
        "telemetry",
        "guardrail_alignment"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "agents": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "id",
              "role",
              "llm_profile",
              "capabilities"
            ],
            "properties": {
              "id": {
                "type": "string",
                "minLength": 1
              },
              "role": {
                "type": "string",
                "minLength": 1
              },
              "llm_profile": {
                "type": "string",
                "minLength": 1
              },
              "capabilities": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "phase_scope": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "tool_access": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "uniqueItems": true
              },
              "hand_off_conditions": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 2,
          "uniqueItems": true
        },
        "coordination_protocol": {
          "type": "object",
          "required": [
            "mode",
            "handshake",
            "message_schema",
            "synchronization"
          ],
          "properties": {
            "mode": {
              "type": "string",
              "enum": [
                "sequential",
                "parallel",
                "hybrid"
              ]
            },
            "handshake": {
              "type": "string",
              "minLength": 1
            },
            "message_schema": {
              "$ref": "#/definitions/schemaOrRef"
            },
            "synchronization": {
              "type": "string",
              "minLength": 1
            },
            "heartbeat_interval_seconds": {
              "type": "number",
              "minimum": 0
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "arbitration": {
          "type": "object",
          "required": [
            "decision_policy",
            "tie_breaker",
            "escalation_path"
          ],
          "properties": {
            "decision_policy": {
              "type": "string",
              "minLength": 1
            },
            "tie_breaker": {
              "type": "string",
              "minLength": 1
            },
            "escalation_path": {
              "type": "string",
              "minLength": 1
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "shared_state": {
          "type": "object",
          "required": [
            "schema",
            "consistency_model",
            "persistence"
          ],
          "properties": {
            "schema": {
              "$ref": "#/definitions/schemaOrRef"
            },
            "consistency_model": {
              "type": "string",
              "enum": [
                "strong",
                "eventual",
                "session",
                "custom"
              ]
            },
            "persistence": {
              "type": "string",
              "minLength": 1
            },
            "encryption": {
              "type": "string"
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "telemetry": {
          "type": "object",
          "required": [
            "metrics",
            "logs",
            "alerts"
          ],
          "properties": {
            "metrics": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "logs": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "alerts": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "guardrail_alignment": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "failure_modes": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "name",
              "mitigation"
            ],
            "properties": {
              "name": {
                "type": "string",
                "minLength": 1
              },
              "mitigation": {
                "type": "string",
                "minLength": 1
              },
              "detection": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "uniqueItems": true
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "latencyBudgetPolicy": {
      "type": "object",
      "required": [
        "name",
        "target_latency_ms",
        "observation_window",
        "phase_bindings",
        "guardrail_links",
        "owner"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "target_latency_ms": {
          "type": "number",
          "minimum": 0
        },
        "observation_window": {
          "type": "string",
          "minLength": 1
        },
        "phase_bindings": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "phase",
              "slo_target_ms",
              "measurement_strategy",
              "enforcement_actions"
            ],
            "properties": {
              "phase": {
                "type": "string",
                "minLength": 1
              },
              "slo_target_ms": {
                "type": "number",
                "minimum": 0
              },
              "alert_threshold_ms": {
                "type": "number",
                "minimum": 0
              },
              "measurement_strategy": {
                "type": "string",
                "minLength": 1
              },
              "enforcement_actions": {
                "type": "array",
                "items": {
                  "type": "string",
                  "minLength": 1
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "fallback_policy": {
                "type": "string"
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "guardrail_links": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "runtime_triggers": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "interactiveDebugTraceSpec": {
      "type": "object",
      "required": [
        "name",
        "phase",
        "triggers",
        "step_schema",
        "storage",
        "replay"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "phase": {
          "type": "string",
          "minLength": 1
        },
        "triggers": {
          "type": "array",
          "items": {
            "type": "object",
            "required": [
              "type",
              "expression"
            ],
            "properties": {
              "type": {
                "type": "string",
                "enum": [
                  "manual",
                  "metric_threshold",
                  "error_code",
                  "sampling",
                  "custom"
                ]
              },
              "expression": {
                "type": "string",
                "minLength": 1
              },
              "notes": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "patternProperties": {
              "^x-": {}
            }
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "step_schema": {
          "$ref": "#/definitions/schemaOrRef"
        },
        "capture_interval": {
          "type": "string"
        },
        "storage": {
          "type": "object",
          "required": [
            "location",
            "retention_days",
            "access_controls"
          ],
          "properties": {
            "location": {
              "type": "string",
              "format": "uri"
            },
            "retention_days": {
              "type": "integer",
              "minimum": 1
            },
            "access_controls": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "encryption": {
              "type": "string"
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "redaction": {
          "type": "object",
          "required": [
            "policies"
          ],
          "properties": {
            "policies": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "pii_scrubbing": {
              "type": "boolean"
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "replay": {
          "type": "object",
          "required": [
            "instructions",
            "tooling"
          ],
          "properties": {
            "instructions": {
              "type": "string",
              "minLength": 1
            },
            "tooling": {
              "type": "string",
              "minLength": 1
            },
            "prerequisites": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "automatedSpecLintingRule": {
      "type": "object",
      "required": [
        "name",
        "target",
        "rule_type",
        "severity",
        "logic",
        "failure_actions"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "description": {
          "type": "string"
        },
        "target": {
          "type": "string",
          "enum": [
            "meta",
            "algorithm",
            "implementation",
            "phase_contract",
            "schema_fragment",
            "runtime_controls",
            "compliance_program",
            "deployment"
          ]
        },
        "rule_type": {
          "type": "string",
          "enum": [
            "structural",
            "semantic",
            "security",
            "compliance",
            "style"
          ]
        },
        "severity": {
          "type": "string",
          "enum": [
            "info",
            "low",
            "medium",
            "high",
            "critical"
          ]
        },
        "logic": {
          "type": "object",
          "required": [
            "engine",
            "expression"
          ],
          "properties": {
            "engine": {
              "type": "string",
              "enum": [
                "jsonpath",
                "jq",
                "cel",
                "custom"
              ]
            },
            "expression": {
              "type": "string",
              "minLength": 1
            },
            "data_sources": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            },
            "exemptions": {
              "type": "array",
              "items": {
                "type": "string",
                "minLength": 1
              },
              "uniqueItems": true
            },
            "notes": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "patternProperties": {
            "^x-": {}
          }
        },
        "failure_actions": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 1
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "auto_fix": {
          "type": "boolean"
        },
        "owner": {
          "type": "string",
          "minLength": 1
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    },
    "complianceEvidenceProof": {
      "type": "object",
      "required": [
        "id",
        "control_id",
        "proof_type",
        "artifact_uri",
        "hash",
        "issued_at",
        "issuer",
        "verification_method"
      ],
      "properties": {
        "id": {
          "type": "string",
          "minLength": 1
        },
        "control_id": {
          "type": "string",
          "minLength": 1
        },
        "proof_type": {
          "type": "string",
          "enum": [
            "hash",
            "digital_signature",
            "zero_knowledge",
            "attestation",
            "custom"
          ]
        },
        "artifact_uri": {
          "type": "string",
          "format": "uri"
        },
        "hash": {
          "$ref": "#/definitions/artifactHash"
        },
        "signature_algorithm": {
          "type": "string"
        },
        "signature_value": {
          "type": "string",
          "minLength": 32
        },
        "issued_at": {
          "type": "string",
          "format": "date-time"
        },
        "issuer": {
          "type": "string",
          "minLength": 1
        },
        "verification_method": {
          "type": "string",
          "minLength": 1
        },
        "valid_until": {
          "type": "string",
          "format": "date-time"
        },
        "notes": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "patternProperties": {
        "^x-": {}
      }
    }
  },
  "properties": {
    "spec_version": {
      "$ref": "#/definitions/semver",
      "description": "Version of this specification/schema; not the version of the described document."
    },
    "meta": {
      "type": "object",
      "required": [
        "title",
        "version",
        "governance",
        "risk_register",
        "lineage",
        "impact_analysis",
        "safety_benchmark_coverage",
        "privacy_budget",
        "data_retention_policies",
        "knowledge_base_links",
        "user_research_insight_catalog",
        "service_level_negotiations",
        "ci_compliance_gates"
      ],
      "properties": {
        "title": {
          "type": "string",
          "minLength": 1
        },
        "version": {
          "$ref": "#/definitions/semver"
        },
        "purpose": {
          "type": "string"
        },
        "notes": {
          "type": "string"
        },
        "governance": {
          "$ref": "#/definitions/governanceProfile"
        },
        "risk_register": {
          "$ref": "#/definitions/riskRegister"
        },
        "lineage": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/lineageRecord"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "impact_analysis": {
          "$ref": "#/definitions/impactAnalysis"
        },
        "safety_benchmark_coverage": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/safetyBenchmarkCoverage"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "privacy_budget": {
          "$ref": "#/definitions/privacyBudgetPolicy"
        },
        "data_retention_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataRetentionPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "knowledge_base_links": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/knowledgeBaseLink"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "user_research_insight_catalog": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/userResearchInsight"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "service_level_negotiations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/serviceLevelNegotiation"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "ci_compliance_gates": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ciComplianceGate"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "algorithm": {
      "type": "object",
      "required": [
        "name",
        "graph",
        "outputs",
        "state_machine",
        "loop_validation_tables"
      ],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 1
        },
        "phases": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "minLength": 1
          },
          "uniqueItems": true
        },
        "graph": {
          "$ref": "#/definitions/controlFlowGraph"
        },
        "outputs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compositionOutput"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "state_machine": {
          "$ref": "#/definitions/stateMachine"
        },
        "loop_validation_tables": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/loopValidationTable"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "implementation": {
      "type": "object",
      "required": [
        "language",
        "entrypoint",
        "return_contract",
        "phase_contracts",
        "phase_explainability_reports",
        "source",
        "schema_fragments",
        "data_lineage",
        "data_dependency_matrix",
        "compiler_ir_manifests",
        "runtime_controls",
        "tool_policies",
        "assurance_program",
        "incident_playbooks",
        "privacy_incident_workflows",
        "remediation_playbooks",
        "vulnerability_disclosure_workflows",
        "continual_learning_governance",
        "model_fallback_strategies",
        "deployment",
        "multi_region_disaster_recovery_manifest",
        "waivers",
        "compliance_programs",
        "persistence_policy",
        "persistence_manifest",
        "toolchain_manifest",
        "release_packaging_manifest",
        "audit_event_signatures",
        "fairness_drift_root_cause_reports",
        "configuration_drift_manifests",
        "prompt_injection_detection_profiles",
        "ethical_review_decision_log",
        "localization_quality_metrics",
        "compiler_optimization_hints",
        "runtime_safety_nets",
        "phase_checkpoint_policies",
        "observability_contract_versions",
        "llm_output_signature_policies",
        "anomaly_budget_policies",
        "data_egress_controls",
        "model_confidence_annotations",
        "quantum_resilience_policies",
        "responsible_ai_commitments",
        "user_persona_access_profiles",
        "phased_rollout_experiments",
        "incident_metrics",
        "third_party_audit_attestations",
        "multi_agent_coordination_contracts",
        "latency_budget_policies",
        "interactive_debug_trace_specs",
        "automated_spec_linting_rules",
        "compliance_evidence_ledger"
      ],
      "properties": {
        "language": {
          "type": "string",
          "minLength": 1
        },
        "entrypoint": {
          "type": "string",
          "minLength": 1
        },
        "parameters": {
          "type": "object",
          "additionalProperties": {
            "oneOf": [
              {
                "type": "string",
                "minLength": 1
              },
              {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string"
                  },
                  "required": {
                    "type": "boolean"
                  },
                  "default": {},
                  "description": {
                    "type": "string"
                  },
                  "enum": {
                    "type": "array"
                  },
                  "schema": {
                    "type": "object"
                  }
                },
                "additionalProperties": false
              }
            ]
          }
        },
        "return_contract": {
          "type": "object",
          "required": [
            "schema"
          ],
          "properties": {
            "schema": {
              "$ref": "#/definitions/schemaOrRef"
            },
            "produced_by": {
              "$ref": "#/definitions/phaseOutputRef"
            }
          },
          "additionalProperties": false
        },
        "phase_contracts": {
          "type": "object",
          "minProperties": 1,
          "propertyNames": {
            "type": "string",
            "minLength": 1
          },
          "additionalProperties": {
            "type": "object",
            "required": [
              "inputs",
              "outputs",
              "event_triggers",
              "errors",
              "semantics",
              "observability",
              "human_review",
              "human_escalation_templates",
              "fairness_checks",
              "behavioral_contracts",
              "tool_capability_scopes",
              "deprecation_plan"
            ],
            "properties": {
              "description": {
                "type": "string"
              },
              "inputs": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/phaseInput"
                }
              },
              "outputs": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/phaseOutput"
                }
              },
              "event_triggers": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/eventDrivenPhaseTrigger"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "errors": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/phaseError"
                },
                "uniqueItems": true,
                "minItems": 1
              },
              "retry_policy": {
                "$ref": "#/definitions/retryPolicy"
              },
              "fallback": {
                "$ref": "#/definitions/phaseFallback"
              },
              "semantics": {
                "$ref": "#/definitions/phaseSemantics"
              },
              "observability": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/observabilityHook"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "human_review": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/humanReviewProtocol"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "human_escalation_templates": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/humanEscalationTemplate"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "fairness_checks": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/ethicalGuardrail"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "behavioral_contracts": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/llmBehavioralContract"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "tool_capability_scopes": {
                "type": "array",
                "items": {
                  "$ref": "#/definitions/phaseToolCapabilityScope"
                },
                "minItems": 1,
                "uniqueItems": true
              },
              "deprecation_plan": {
                "$ref": "#/definitions/phaseDeprecationPlan"
              }
            },
            "additionalProperties": false,
            "allOf": [
              {
                "if": {
                  "properties": {
                    "errors": {
                      "contains": {
                        "properties": {
                          "severity": {
                            "const": "retryable"
                          }
                        },
                        "required": [
                          "severity"
                        ]
                      }
                    }
                  },
                  "required": [
                    "errors"
                  ]
                },
                "then": {
                  "required": [
                    "retry_policy"
                  ]
                }
              }
            ]
          }
        },
        "phase_explainability_reports": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phaseExplainabilityReport"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "source": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/artifactSource"
          },
          "minItems": 1
        },
        "schema_fragments": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/migratableSchemaFragment"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "data_lineage": {
          "$ref": "#/definitions/dataLineage"
        },
        "data_dependency_matrix": {
          "$ref": "#/definitions/dataDependencyMatrix"
        },
        "compiler_ir_manifests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compilerIRManifest"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "formats": {},
        "runtime_controls": {
          "$ref": "#/definitions/runtimeControls"
        },
        "tool_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/toolPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "assurance_program": {
          "$ref": "#/definitions/assuranceProgram"
        },
        "incident_playbooks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/incidentPlaybook"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "privacy_incident_workflows": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/privacyIncidentWorkflow"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "remediation_playbooks": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/remediationPlaybook"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "vulnerability_disclosure_workflows": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/vulnerabilityDisclosureWorkflow"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "continual_learning_governance": {
          "$ref": "#/definitions/continualLearningGovernance"
        },
        "model_fallback_strategies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/modelFallbackStrategy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "deployment": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/deploymentEnvironment"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "multi_region_disaster_recovery_manifest": {
          "$ref": "#/definitions/multiRegionDisasterRecoveryManifest"
        },
        "waivers": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/waiverRecord"
          },
          "uniqueItems": true
        },
        "compliance_programs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/complianceProgram"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "persistence_policy": {
          "$ref": "#/definitions/persistencePolicy"
        },
        "persistence_manifest": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/persistenceManifestEntry"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "toolchain_manifest": {
          "$ref": "#/definitions/toolchainManifest"
        },
        "release_packaging_manifest": {
          "$ref": "#/definitions/releasePackagingManifest"
        },
        "audit_event_signatures": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/auditEventSignature"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "fairness_drift_root_cause_reports": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/fairnessDriftRootCauseReport"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "configuration_drift_manifests": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/configurationDriftManifest"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "prompt_injection_detection_profiles": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/promptInjectionDetectionProfile"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "ethical_review_decision_log": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ethicalReviewDecisionLogEntry"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "localization_quality_metrics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/localizationQualityMetric"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "compiler_optimization_hints": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/compilerOptimizationHint"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "runtime_safety_nets": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/runtimeSafetyNet"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "phase_checkpoint_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phaseStateCheckpointPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "observability_contract_versions": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/observabilityContractVersion"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "llm_output_signature_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/llmOutputSignaturePolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "anomaly_budget_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/anomalyBudgetPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "data_egress_controls": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/dataEgressControl"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "model_confidence_annotations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/modelConfidenceAnnotation"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "quantum_resilience_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/quantumResiliencePolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "responsible_ai_commitments": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/responsibleAICommitment"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "user_persona_access_profiles": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/userPersonaAccessProfile"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "phased_rollout_experiments": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/phasedRolloutExperiment"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "incident_metrics": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/incidentMetricDefinition"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "third_party_audit_attestations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/thirdPartyAuditAttestation"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "multi_agent_coordination_contracts": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/multiAgentCoordinationContract"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "latency_budget_policies": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/latencyBudgetPolicy"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "interactive_debug_trace_specs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/interactiveDebugTraceSpec"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "automated_spec_linting_rules": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/automatedSpecLintingRule"
          },
          "minItems": 1,
          "uniqueItems": true
        },
        "compliance_evidence_ledger": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/complianceEvidenceProof"
          },
          "minItems": 1,
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    }
  },
  "patternProperties": {
    "^x-": {}
  },
  "required": [
    "spec_version",
    "meta",
    "algorithm",
    "implementation"
  ],
  "additionalProperties": false,
  "description": "Extends the mini-program schema with compiler determinism controls, multi-agent coordination contracts, latency budget governance, interactive debug trace specifications, automated specification linting rules, and machine-verifiable compliance evidence registers, while preserving prior enhancements for optimization hints, runtime safety nets, behavioral guardrails, data governance, and auditability."
}
